<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.1/css/all.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"lessisbetter.site","root":"/","images":"/images","scheme":"Pisces","version":"8.1.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"}};
  </script>
<meta name="description" content="äº‘åŸç”Ÿã€Goè¯­è¨€ã€åŒºå—é“¾">
<meta property="og:type" content="website">
<meta property="og:title" content="Goè¯­è¨€å……ç”µç«™">
<meta property="og:url" content="http://lessisbetter.site/page/2/index.html">
<meta property="og:site_name" content="Goè¯­è¨€å……ç”µç«™">
<meta property="og:description" content="äº‘åŸç”Ÿã€Goè¯­è¨€ã€åŒºå—é“¾">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="å¤§å½¬">
<meta property="article:tag" content="äº‘åŸç”Ÿ k8s kubernetes åŒºå—é“¾ Goè¯­è¨€ åç«¯ æŠ€æœ¯ äººç”Ÿ ç¼–ç¨‹">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://lessisbetter.site/page/2/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>
<title>Goè¯­è¨€å……ç”µç«™</title>
  



  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Goè¯­è¨€å……ç”µç«™</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">å¤§å½¬ less is better</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-ä¸»é¡µ"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>ä¸»é¡µ</a></li>
        <li class="menu-item menu-item-å…³äº"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li>
        <li class="menu-item menu-item-æ ‡ç­¾"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a></li>
        <li class="menu-item menu-item-å½’æ¡£"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a></li>
        <li class="menu-item menu-item-ä¸“é¢˜"><a href="/subject/" rel="section"><i class="fa fa-calendar fa-fw"></i>ä¸“é¢˜</a></li>
        <li class="menu-item menu-item-å¤§ç‰›åšå®¢"><a href="/blogs/" rel="section"><i class="fa fa-calendar fa-fw"></i>å¤§ç‰›åšå®¢</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container"></div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container">
  <div class="algolia-stats"><hr></div>
  <div class="algolia-hits"></div>
  <div class="algolia-pagination"></div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <section class="post-toc-wrap sidebar-panel">
        </section>
        <!--/noindex-->

        <section class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="å¤§å½¬"
      src="https://github.com/Shitaibin/shitaibin.github.io/blob/hexo_resource/images/gzh-qrcode-logo-small.png">
  <p class="site-author-name" itemprop="name">å¤§å½¬</p>
  <div class="site-description" itemprop="description">äº‘åŸç”Ÿã€Goè¯­è¨€ã€åŒºå—é“¾</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">137</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">78</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://xargin.com/" title="Xarginæ›¹å¤§åšå®¢ â†’ https:&#x2F;&#x2F;xargin.com&#x2F;" rel="noopener" target="_blank">Xarginæ›¹å¤§åšå®¢</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://qcrao.github.io/" title="ç å†œæ¡ƒèŠ±æºåšå®¢ â†’ https:&#x2F;&#x2F;qcrao.github.io&#x2F;" rel="noopener" target="_blank">ç å†œæ¡ƒèŠ±æºåšå®¢</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://book.eddycjy.com/golang/" title="ç…é±¼åšå®¢ â†’ https:&#x2F;&#x2F;book.eddycjy.com&#x2F;golang&#x2F;" rel="noopener" target="_blank">ç…é±¼åšå®¢</a>
      </span>
  </div>



        </section>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://lessisbetter.site/2020/08/27/cgroup-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://github.com/Shitaibin/shitaibin.github.io/blob/hexo_resource/images/gzh-qrcode-logo-small.png">
      <meta itemprop="name" content="å¤§å½¬">
      <meta itemprop="description" content="äº‘åŸç”Ÿã€Goè¯­è¨€ã€åŒºå—é“¾">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Goè¯­è¨€å……ç”µç«™">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/27/cgroup-1/" class="post-title-link" itemprop="url">Dockerå®¹å™¨åŸºç¡€1ï¼šCgroup - èµ„æºæ§åˆ¶ç®€ä»‹</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2020-08-27 21:43:52" itemprop="dateCreated datePublished" datetime="2020-08-27T21:43:52+08:00">2020-08-27</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">æ›´æ–°äº</span>
        <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-12-13 16:11:59" itemprop="dateModified" datetime="2020-12-13T16:11:59+08:00">2020-12-13</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="ä»€ä¹ˆæ˜¯Cgroup"><a href="#ä»€ä¹ˆæ˜¯Cgroup" class="headerlink" title="ä»€ä¹ˆæ˜¯Cgroup"></a>ä»€ä¹ˆæ˜¯Cgroup</h2><p>Cgroup æ˜¯ Control Group çš„ç¼©å†™ï¼Œæä¾›å¯¹ä¸€ç»„è¿›ç¨‹ï¼ŒåŠæœªæ¥å­è¿›ç¨‹çš„èµ„æº<strong>é™åˆ¶ã€æ§åˆ¶ã€ç»Ÿè®¡</strong>èƒ½åŠ›ï¼ŒåŒ…æ‹¬CPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œã€‚</p>
<ul>
<li>é™åˆ¶ï¼šé™åˆ¶çš„èµ„æºæœ€å¤§ä½¿ç”¨é‡é˜ˆå€¼ã€‚æ¯”å¦‚ä¸èƒ½è¶…è¿‡128MBå†…å­˜ï¼ŒCPUä½¿ç”¨ç‡ä¸å¾—è¶…è¿‡50%ï¼Œæˆ–è€…åªèƒ½æ˜¯å¦CPUçš„æŸå“ªå‡ ä¸ªæ ¸ã€‚</li>
<li>æ§åˆ¶ï¼šè¶…è¿‡èµ„æºä½¿ç”¨æœ€å¤§é˜ˆå€¼æ—¶ï¼Œè¿›ç¨‹ä¼šè¢«æ§åˆ¶ï¼Œä¸ä»»ç”±å®ƒå‘å±•ã€‚æ¯”å¦‚cgroupå†…æ‰€æœ‰tasksçš„å†…å­˜ä½¿ç”¨é‡è¶…è¿‡é˜ˆå€¼çš„ç»“æœå°±æ˜¯è¢«KILLï¼ŒCPUä½¿ç”¨ç‡ä¸å¾—è¶…è¿‡è®¾å®šå€¼ã€‚</li>
<li>ç»Ÿè®¡ï¼šç»Ÿè®¡èµ„æºçš„ä½¿ç”¨æƒ…å†µç­‰æŒ‡æ ‡ã€‚æ¯”å¦‚cgroupå†…tasksçš„å†…å­˜ä½¿ç”¨é‡ï¼Œå ç”¨CPUçš„æ—¶é—´ã€‚</li>
</ul>
<p>Cgroup åŒ…å«3ä¸ªç»„ä»¶ï¼š</p>
<ul>
<li>cgroup ï¼šä¸€ç»„è¿›ç¨‹ï¼Œå¯ä»¥åŠ ä¸Šsubsystem</li>
<li>subsystem ï¼šä¸€ç»„èµ„æºæ§åˆ¶æ¨¡å—ï¼ŒCPUã€å†…å­˜â€¦</li>
<li>hierarchy ï¼š æŠŠä¸€ç»„cgroupä¸²æˆæ ‘çŠ¶ç»“æ„ï¼Œè¿™æ ·å°±èƒ½å®ç°cgroupçš„ç»§æ‰¿ã€‚ä¸ºä»€ä¹ˆè¦ç»§æ‰¿å‘¢ï¼Ÿå°±å¦‚åŒdockeré•œåƒçš„ç»§æ‰¿ï¼Œç«™åœ¨å‰äººçš„åŸºç¡€ä¹‹ä¸Šï¼Œå…å»é‡å¤çš„é…ç½®</li>
</ul>
<h2 id="ä¸ºä»€ä¹ˆéœ€è¦Cgroup"><a href="#ä¸ºä»€ä¹ˆéœ€è¦Cgroup" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦Cgroup"></a>ä¸ºä»€ä¹ˆéœ€è¦Cgroup</h2><p>ä¸ºä»€ä¹ˆéœ€è¦Cgroupçš„é—®é¢˜ç­‰ä»·äºï¼šä¸ºä»€ä¹ˆéœ€è¦é™åˆ¶ä¸€ç»„è¿›ç¨‹çš„èµ„æºï¼Ÿ</p>
<p>æœ‰å¤šç§åŸå› ï¼Œæ¯”å¦‚ï¼š</p>
<ol>
<li>Linuxæ˜¯ä¸€ä¸ªå¯ä»¥å¤šç”¨æˆ·ç™»å½•çš„ç³»ç»Ÿï¼Œå¦‚ä½•é™åˆ¶ä¸åŒçš„ç”¨æˆ·ä½¿ç”¨ä¸åŒé‡çš„ç³»ç»Ÿèµ„æºå‘¢ï¼Ÿ</li>
<li>æŸä¸ªç³»ç»Ÿæœ‰64æ ¸ï¼Œç”±äºå±€éƒ¨æ€§åŸç†ï¼Œå¦‚æœä¸€ç»„è¿›ç¨‹åœ¨64ä¸ªæ ¸ä¸Šè°ƒåº¦ï¼Œæ•ˆç‡æ¯”è¾ƒä½ï¼Œä½†æŠŠè¿™äº›è¿›ç¨‹åªå…è®¸åœ¨æŸå‡ ä¸ªæ ¸ä¸Šè°ƒåº¦ï¼Œå°±æœ‰è¾ƒå¥½çš„å±€éƒ¨æ€§ï¼Œæé«˜æ•ˆç‡ã€‚è¿™ç±»ä¼¼ä¸åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼ŒæŸä¸ªæœ‰çŠ¶æ€çš„è¯·æ±‚ï¼Œæœ€å¥½èƒ½åˆ†é…åˆ°ä¸Šä¸€æ¬¡å¤„ç†è¯¥è¯·æ±‚çš„æœºå™¨ä¸Šä¸€æ ·çš„é“ç†ã€‚</li>
</ol>
<p>cgroupçš„æ–‡æ¡£ä¸­è¿˜æåˆ°ä¸€ä¸ªæ€è·¯ï¼šå®ç°èµ„æºé™åˆ¶çš„æŠ€æœ¯æœ‰å¤šç§ï¼Œä¸ºä»€ä¹ˆä½¿ç”¨cgroupï¼Ÿ</p>
<p>cgroupæ˜¯å†…æ ¸å®ç°çš„ï¼Œå®ƒæ›´è½»é‡ã€æ›´é«˜æ•ˆã€å¯¹å†…æ ¸çš„çƒ­ç‚¹è·¯å¾„å½±å“æœ€å°ã€‚</p>
<h2 id="ä½ çš„Linuxæ”¯æŒå“ªäº›Cgroup-subsystem"><a href="#ä½ çš„Linuxæ”¯æŒå“ªäº›Cgroup-subsystem" class="headerlink" title="ä½ çš„Linuxæ”¯æŒå“ªäº›Cgroup subsystem"></a>ä½ çš„Linuxæ”¯æŒå“ªäº›Cgroup subsystem</h2><p>æŸ¥çœ‹å½“å‰ç³»ç»Ÿæ”¯æŒçš„subsystemï¼Œå…±12ä¸ªå­ç³»ç»Ÿã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[&#x2F;sys&#x2F;fs&#x2F;cgroup]$ cat &#x2F;proc&#x2F;cgroups</span><br><span class="line">#subsys_name	hierarchy	num_cgroups	enabled</span><br><span class="line">cpuset	8	4	1</span><br><span class="line">cpu	2	74	1</span><br><span class="line">cpuacct	2	74	1</span><br><span class="line">memory	11	74	1</span><br><span class="line">devices	6	69	1</span><br><span class="line">freezer	10	4	1</span><br><span class="line">net_cls	4	4	1</span><br><span class="line">blkio	9	69	1</span><br><span class="line">perf_event	5	4	1</span><br><span class="line">hugetlb	7	4	1</span><br><span class="line">pids	3	69	1</span><br><span class="line">net_prio	4	4	1</span><br></pre></td></tr></table></figure>

<p>ä»å·¦åˆ°å³å­—æ®µçš„å«ä¹‰åˆ†åˆ«æ˜¯ï¼š</p>
<ol>
<li>subsys_name: subsystemçš„åå­—</li>
<li>hierarchy: subsystemæ‰€å…³è”åˆ°çš„cgroupæ ‘çš„IDï¼Œå¦‚æœå¤šä¸ªsubsystemå…³è”åˆ°åŒä¸€é¢—cgroupæ ‘ï¼Œé‚£ä¹ˆä»–ä»¬çš„è¿™ä¸ªå­—æ®µå°†ä¸€æ ·ï¼Œæ¯”å¦‚è¿™é‡Œçš„cpuå’Œcpuacctå°±ä¸€æ ·ï¼Œè¡¨ç¤ºä»–ä»¬ç»‘å®šåˆ°äº†åŒä¸€é¢—æ ‘ã€‚å¦‚æœå‡ºç°ä¸‹é¢çš„æƒ…å†µï¼Œè¿™ä¸ªå­—æ®µå°†ä¸º0ï¼š<ul>
<li>å½“å‰subsystemæ²¡æœ‰å’Œä»»ä½•cgroupæ ‘ç»‘å®š</li>
<li>å½“å‰subsystemå·²ç»å’Œcgroup v2çš„æ ‘ç»‘å®š</li>
<li>å½“å‰subsystemæ²¡æœ‰è¢«å†…æ ¸å¼€å¯</li>
</ul>
</li>
<li>num_cgroups: subsystemæ‰€å…³è”çš„cgroupæ ‘ä¸­è¿›ç¨‹ç»„çš„ä¸ªæ•°ï¼Œä¹Ÿå³æ ‘ä¸ŠèŠ‚ç‚¹çš„ä¸ªæ•°</li>
<li>enabled: 1è¡¨ç¤ºå¼€å¯ï¼Œ0è¡¨ç¤ºæ²¡æœ‰è¢«å¼€å¯(å¯ä»¥é€šè¿‡è®¾ç½®å†…æ ¸çš„å¯åŠ¨å‚æ•°â€œcgroup_disableâ€æ¥æ§åˆ¶subsystemçš„å¼€å¯).</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://www.kernel.org/doc/Documentation/cgroup-v1/">Cgroupçš„å†…æ ¸æ–‡æ¡£</a>å¯¹å„ cgroup å’Œ subsystem æœ‰è¯¦ç»†çš„ä»‹ç»ï¼Œä»¥ä¸‹æ˜¯æ¯ä¸ª subsystem åŠŸèƒ½ç®€è®°ï¼š</p>
<ol>
<li>cpu ï¼šç”¨æ¥<strong>é™åˆ¶</strong>cgroupçš„CPUä½¿ç”¨ç‡</li>
<li>cpuacct ï¼šç”¨æ¥<strong>ç»Ÿè®¡</strong>cgroupçš„CPUçš„ä½¿ç”¨ç‡</li>
<li>cpuset ï¼š ç”¨æ¥ç»‘å®šcgroupåˆ°æŒ‡å®šCPUå“ªä¸ªæ ¸ä¸Šå’ŒNUMAèŠ‚ç‚¹</li>
<li>memory ï¼šé™åˆ¶å’Œç»Ÿè®¡cgroupçš„å†…å­˜çš„ä½¿ç”¨ç‡ï¼ŒåŒ…æ‹¬process memory, kernel memory, å’Œswap</li>
<li>devices ï¼š é™åˆ¶cgroupåˆ›å»º(mknod)å’Œè®¿é—®è®¾å¤‡çš„æƒé™</li>
<li>freezer ï¼š suspendå’Œrestoreä¸€ä¸ªcgroupä¸­çš„æ‰€æœ‰è¿›ç¨‹</li>
<li>net_cls ï¼š å°†ä¸€ä¸ªcgroupä¸­è¿›ç¨‹åˆ›å»ºçš„æ‰€æœ‰ç½‘ç»œåŒ…åŠ ä¸Šä¸€ä¸ªclassidæ ‡è®°ï¼Œç”¨äºtcå’Œiptablesã€‚ åªå¯¹å‘å‡ºå»çš„ç½‘ç»œåŒ…ç”Ÿæ•ˆï¼Œå¯¹æ”¶åˆ°çš„ç½‘ç»œåŒ…ä¸èµ·ä½œç”¨</li>
<li>blkio ï¼š é™åˆ¶cgroupè®¿é—®å—è®¾å¤‡çš„IOé€Ÿåº¦</li>
<li>perf_event ï¼š å¯¹cgroupè¿›è¡Œæ€§èƒ½ç›‘æ§</li>
<li>net_prio ï¼š é’ˆå¯¹æ¯ä¸ªç½‘ç»œæ¥å£è®¾ç½®cgroupçš„è®¿é—®ä¼˜å…ˆçº§</li>
<li>hugetlb ï¼š é™åˆ¶cgroupçš„huge pagesçš„ä½¿ç”¨é‡</li>
<li>pids ï¼šé™åˆ¶ä¸€ä¸ªcgroupåŠå…¶å­å­™cgroupä¸­çš„æ€»è¿›ç¨‹æ•°</li>
</ol>
<p>è¿™äº›å­ç³»ç»Ÿçš„æ’åˆ—é¡ºåºï¼Œå°±æ˜¯å¼•å…¥Linuxå†…æ ¸é¡ºåºï¼Œæœ€æ—©çš„æ˜¯cpu subsystem ï¼Œå¼•å…¥è‡ªLinux 2.6.24ï¼Œæœ€æ™šçš„æ˜¯pid subsystem ï¼Œå¼•å…¥è‡ª Linux 4.3ã€‚</p>
<h2 id="æŸ¥çœ‹å­ç³»ç»Ÿå’Œcgroupçš„æŒ‚è½½"><a href="#æŸ¥çœ‹å­ç³»ç»Ÿå’Œcgroupçš„æŒ‚è½½" class="headerlink" title="æŸ¥çœ‹å­ç³»ç»Ÿå’Œcgroupçš„æŒ‚è½½"></a>æŸ¥çœ‹å­ç³»ç»Ÿå’Œcgroupçš„æŒ‚è½½</h2><p>cgroupæ˜¯é€šè¿‡æ–‡ä»¶ç³»ç»Ÿå®ç°çš„ï¼Œæ¯ä¸ªç›®å½•éƒ½æ˜¯ä¸€ä¸ªcgroupèŠ‚ç‚¹ï¼Œç›®å½•ä¸­çš„å­ç›®å½•éƒ½æ˜¯å­cgroupèŠ‚ç‚¹ï¼Œè¿™æ ·å°±å½¢æˆäº† cgroupçš„ hierarchy ç‰¹æ€§ã€‚</p>
<p>cgroupä¼šæŒ‚è½½åˆ° <code>/sys/fs/cgroup/</code>ç›®å½•ï¼Œè¯¥ç›®å½•ä¸‹çš„ç›®å½•åŸºæœ¬éƒ½æ˜¯subsystemï¼Œ<code>systemd</code>ç›®å½•é™¤å¤–ï¼ˆå®ƒæ˜¯ systemd è‡ªå»ºåœ¨cgroupä¸‹çš„ç›®å½•ï¼Œä½†ä¸æ˜¯å­ç³»ç»Ÿï¼‰ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[&#x2F;sys&#x2F;fs&#x2F;cgroup]$ ll</span><br><span class="line">total 0</span><br><span class="line">dr-xr-xr-x 6 root root  0 Aug 30 09:30 blkio</span><br><span class="line">lrwxrwxrwx 1 root root 11 Aug 30 09:30 cpu -&gt; cpu,cpuacct</span><br><span class="line">lrwxrwxrwx 1 root root 11 Aug 30 09:30 cpuacct -&gt; cpu,cpuacct</span><br><span class="line">dr-xr-xr-x 7 root root  0 Aug 30 09:30 cpu,cpuacct</span><br><span class="line">dr-xr-xr-x 3 root root  0 Aug 30 09:30 cpuset</span><br><span class="line">dr-xr-xr-x 6 root root  0 Aug 30 09:30 devices</span><br><span class="line">dr-xr-xr-x 3 root root  0 Aug 30 09:30 freezer</span><br><span class="line">dr-xr-xr-x 3 root root  0 Aug 30 09:30 hugetlb</span><br><span class="line">dr-xr-xr-x 6 root root  0 Aug 30 09:30 memory</span><br><span class="line">lrwxrwxrwx 1 root root 16 Aug 30 09:30 net_cls -&gt; net_cls,net_prio</span><br><span class="line">dr-xr-xr-x 3 root root  0 Aug 30 09:30 net_cls,net_prio</span><br><span class="line">lrwxrwxrwx 1 root root 16 Aug 30 09:30 net_prio -&gt; net_cls,net_prio</span><br><span class="line">dr-xr-xr-x 3 root root  0 Aug 30 09:30 perf_event</span><br><span class="line">dr-xr-xr-x 6 root root  0 Aug 30 09:30 pids</span><br><span class="line">dr-xr-xr-x 6 root root  0 Aug 30 09:30 systemd</span><br></pre></td></tr></table></figure>

<p>å‘ç°cpuã€cpuacctéƒ½æŒ‡å‘äº† <code>cpu,cpuacct</code> ç›®å½•ï¼ŒæŠŠå®ƒä»¬åˆæˆäº†1ä¸ªcgroupèŠ‚ç‚¹ã€‚å¦å¤– net_cls å’Œ net_prio ä¹Ÿéƒ½åˆåˆ°äº† <code>net_cls,net_prio</code> èŠ‚ç‚¹ï¼Œä¹Ÿå°±å½¢æˆäº†ä¸‹é¢è¿™å¹…å›¾çš„æ ·å­ï¼Œå¹¶æŠŠèµ„æºæ§åˆ¶åˆ†æˆäº†5ä¸ªç±»åˆ«ï¼šCPUã€å†…å­˜ã€ç½‘ç»œã€è¿›ç¨‹æ§åˆ¶ã€è®¾å¤‡ï¼Œå¦å¤–çš„<code>perf_event</code>æ˜¯cgroupå¯¹è‡ªèº«çš„ç›‘æ§ï¼Œä¸å½’äºèµ„æºæ§åˆ¶ã€‚</p>
<p><img src="http://img.lessisbetter.site/2020-08-30-cgroup-subsystem.png"></p>
<p>å­ç³»ç»ŸæŒ‚è½½åˆ°cgroupçš„è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿæ˜¯é€šè¿‡mountå‘½ä»¤å®ç°çš„ï¼Œç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨æŒ‚è½½subsystemåˆ°cgroupï¼ŒæŸ¥çœ‹å·²ç»æŒ‚è½½çš„Cgroupï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[~]$ mount -t cgroup</span><br><span class="line">cgroup on &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;systemd type cgroup (rw,nosuid,nodev,noexec,relatime,xattr,release_agent&#x3D;&#x2F;lib&#x2F;systemd&#x2F;systemd-cgroups-agent,name&#x3D;systemd)</span><br><span class="line">cgroup on &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;memory type cgroup (rw,nosuid,nodev,noexec,relatime,memory)</span><br><span class="line">cgroup on &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;pids type cgroup (rw,nosuid,nodev,noexec,relatime,pids)</span><br><span class="line">cgroup on &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;cpu,cpuacct type cgroup (rw,nosuid,nodev,noexec,relatime,cpu,cpuacct)</span><br><span class="line">cgroup on &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;freezer type cgroup (rw,nosuid,nodev,noexec,relatime,freezer)</span><br><span class="line">cgroup on &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;net_cls,net_prio type cgroup (rw,nosuid,nodev,noexec,relatime,net_cls,net_prio)</span><br><span class="line">cgroup on &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;devices type cgroup (rw,nosuid,nodev,noexec,relatime,devices)</span><br><span class="line">cgroup on &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;cpuset type cgroup (rw,nosuid,nodev,noexec,relatime,cpuset)</span><br><span class="line">cgroup on &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;blkio type cgroup (rw,nosuid,nodev,noexec,relatime,blkio)</span><br><span class="line">cgroup on &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;hugetlb type cgroup (rw,nosuid,nodev,noexec,relatime,hugetlb)</span><br><span class="line">cgroup on &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;perf_event type cgroup (rw,nosuid,nodev,noexec,relatime,perf_event)</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æŸä¸ªè¿›ç¨‹æ‰€å±çš„cgroupï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[&#x2F;sys&#x2F;fs&#x2F;cgroup]$ # $$ä»£è¡¨å½“å‰è¿›ç¨‹</span><br><span class="line">[&#x2F;sys&#x2F;fs&#x2F;cgroup]$ cat &#x2F;proc&#x2F;$$&#x2F;cgroup</span><br><span class="line">11:memory:&#x2F;user.slice&#x2F;user-1000.slice&#x2F;session-269.scope</span><br><span class="line">10:freezer:&#x2F;</span><br><span class="line">9:blkio:&#x2F;user.slice</span><br><span class="line">8:cpuset:&#x2F;</span><br><span class="line">7:hugetlb:&#x2F;</span><br><span class="line">6:devices:&#x2F;user.slice</span><br><span class="line">5:perf_event:&#x2F;</span><br><span class="line">4:net_prio,net_cls:&#x2F;</span><br><span class="line">3:pids:&#x2F;user.slice</span><br><span class="line">2:cpuacct,cpu:&#x2F;user.slice&#x2F;user-1000.slice&#x2F;session-269.scope</span><br><span class="line">1:name&#x3D;systemd:&#x2F;user.slice&#x2F;user-1000.slice&#x2F;session-269.scope</span><br></pre></td></tr></table></figure>

<p>æ¯ä¸€è¡Œä»å·¦åˆ°å³ï¼Œç”¨<code>:</code>åˆ†å‰²ä¾æ¬¡æ˜¯ï¼š</p>
<ul>
<li><code>11</code>ï¼š cgroupç»§æ‰¿æ ‘çš„èŠ‚ç‚¹çš„ID</li>
<li><code>memory</code>: å½“å‰èŠ‚ç‚¹ä¸ŠæŒ‚è½½çš„å­ç³»ç»Ÿ</li>
<li><code>/user.slice/user-1000.slice/session-269.scope</code>: cgroupèŠ‚ç‚¹ç›¸å¯¹äºcgroupæ ¹ç›®å½•ä¸‹å­ç³»ç»Ÿçš„ç›¸å¯¹è·¯å¾„ï¼Œè½¬æ¢æˆç»å¯¹è·¯å¾„å°±æ˜¯ï¼š<code>/sys/fs/cgroup/memory/user.slice/user-1000.slice/session-269.scope</code></li>
</ul>
<h2 id="å†èŠcgroup-hierarchy"><a href="#å†èŠcgroup-hierarchy" class="headerlink" title="å†èŠcgroup hierarchy"></a>å†èŠcgroup hierarchy</h2><p>åœ¨ cpu,cpuacct å­ç³»ç»Ÿä¸‹åˆ›å»ºä¸€ä¸ªæµ‹è¯•cgroupèŠ‚ç‚¹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[/sys/fs/cgroup/cpu,cpuacct]$ sudo mkdir dabin_test_cpu_cgroup</span><br><span class="line">[/sys/fs/cgroup/cpu,cpuacct]$ <span class="built_in">cd</span> dabin_test_cpu_cgroup</span><br><span class="line">[/sys/fs/cgroup/cpu,cpuacct/dabin_test_cpu_cgroup]$ ls</span><br><span class="line">[/sys/fs/cgroup/cpu,cpuacct/dabin_test_cpu_cgroup]$ ls cgroup.*</span><br><span class="line">cgroup.clone_children  cgroup.event_control  cgroup.procs</span><br><span class="line">[/sys/fs/cgroup/cpu,cpuacct/dabin_test_cpu_cgroup]$ cat cgroup.clone_children</span><br><span class="line">0</span><br><span class="line">[/sys/fs/cgroup/cpu,cpuacct/dabin_test_cpu_cgroup]$ cat cgroup.procs</span><br><span class="line">[/sys/fs/cgroup/cpu,cpuacct/dabin_test_cpu_cgroup]$</span><br><span class="line">[/sys/fs/cgroup/cpu,cpuacct/dabin_test_cpu_cgroup]$ ls notify_on_release tasks</span><br><span class="line">notify_on_release  tasks</span><br><span class="line">[/sys/fs/cgroup/cpu,cpuacct/dabin_test_cpu_cgroup]$</span><br><span class="line">[/sys/fs/cgroup/cpu,cpuacct/dabin_test_cpu_cgroup]$ cat tasks</span><br><span class="line">[/sys/fs/cgroup/cpu,cpuacct/dabin_test_cpu_cgroup]$ cat notify_on_release</span><br><span class="line">0</span><br></pre></td></tr></table></figure>

<p>cgroup hierarchy (ç»§æ‰¿æ ‘)ç»“æ„ï¼Œæ¯ä¸ªcgroupèŠ‚ç‚¹éƒ½åŒ…å«ä»¥ä¸‹å‡ ä¸ªæ–‡ä»¶ï¼š</p>
<ul>
<li>cgroup.clone_children : è¢«cpusetæ§åˆ¶å™¨ä½¿ç”¨ï¼Œå€¼ä¸º1æ—¶å­cgroupåˆå§‹åŒ–æ—¶æ‹·è´çˆ¶cgroupçš„é…ç½®</li>
<li>cgroup.procs : cgroupä¸­çš„çº¿ç¨‹ç»„id</li>
<li>tasks : å½“å‰cgroupåŒ…å«çš„è¿›ç¨‹åˆ—è¡¨</li>
<li>notify_on_release : å€¼ä¸º0æˆ–1ï¼Œ1ä»£è¡¨å½“cgroupä¸­çš„æœ€å1ä¸ªtaské€€å‡ºï¼Œå¹¶ä¸”å­cgroupç§»é™¤æ—¶ï¼Œå†…æ ¸ä¼šåœ¨ç»§æ‰¿æ ‘æ ¹ç›®å½•è¿è¡Œ<code>release_agent</code>æ–‡ä»¶</li>
</ul>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>cgroupå¯¹ä¸€ç»„è¿›ç¨‹çš„èµ„æºè¿›è¡Œæ§åˆ¶ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºCPUã€å†…å­˜ã€ç½‘ç»œã€ç£ç›˜ç­‰èµ„æºï¼Œå…±12ç§èµ„æºï¼Œé€šè¿‡12ä¸ªsubsystemå»è¿›è¡Œé™åˆ¶ã€æ§åˆ¶ã€‚</p>
<p>cgroupç”±å†…æ ¸ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿå®ç°ï¼Œæ–‡ä»¶ç³»ç»Ÿçš„å±‚çº§ç»“æ„å®ç°äº†cgroupçš„å±‚çº§ç»“æ„ï¼Œå®ƒé»˜è®¤æŒ‚è½½åˆ° <code>/sys/fs/cgroup</code> ç›®å½•ã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ol>
<li><a target="_blank" rel="noopener" href="https://kernel.googlesource.com/pub/scm/linux/kernel/git/glommer/memcg/+/cpu_stat/Documentation/cgroups">Linux Kernel Cgroupçš„æ–‡æ¡£</a></li>
<li><a target="_blank" rel="noopener" href="https://union-click.jd.com/jdc?e=&p=AyIGZRtSFwsWB1EcXhUyFQ5WEloVCxMBURxrUV1KWQorAlBHU0VeBUVNR0ZbSkdETlcNVQtHRVNSUVNLXANBRA1XB14DS10cQQVYD21XHgBcGFIUAhsGUx9cJQEbBTJbEmFdcHkRSANGBhBDCnkmEVQeC2UaaxUDEwVWEl8RBhM3ZRtcJUN8B1QaUxMCFAFlGmsVBhoOUx9fFwESB1IfaxICGzeDtdnBl4nT2YZrJTIRN2UrWyUBIkU7HQxBABEGBhILHVdGAgcaXB0DQARWHQ4QVhFVVhkLEVciBVQaXxw=">é˜¿é‡ŒåŒå­¦çš„ä¹¦ã€Šè‡ªå·±åŠ¨æ‰‹å†™Dockerã€‹</a></li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://lessisbetter.site/2020/08/27/play-minikube/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://github.com/Shitaibin/shitaibin.github.io/blob/hexo_resource/images/gzh-qrcode-logo-small.png">
      <meta itemprop="name" content="å¤§å½¬">
      <meta itemprop="description" content="äº‘åŸç”Ÿã€Goè¯­è¨€ã€åŒºå—é“¾">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Goè¯­è¨€å……ç”µç«™">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/27/play-minikube/" class="post-title-link" itemprop="url">ç©è½¬minikube</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2020-08-27 21:30:41" itemprop="dateCreated datePublished" datetime="2020-08-27T21:30:41+08:00">2020-08-27</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">æ›´æ–°äº</span>
        <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-12-13 16:11:59" itemprop="dateModified" datetime="2020-12-13T16:11:59+08:00">2020-12-13</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>minikubeå¾ˆå¥½ï¼Œä½†æŸäº›åŸå› é€ æˆå›½å†…ç”¨èµ·æ¥æ¯”è¾ƒæ…¢ï¼Œè¦å„ç§æŒ‚ä»£ç†ã€Dockeré•œåƒåŠ é€Ÿã€‚</p>
<h2 id="minikubeåŸç†"><a href="#minikubeåŸç†" class="headerlink" title="minikubeåŸç†"></a>minikubeåŸç†</h2><p><img src="http://img.lessisbetter.site/2020-08-minikube.jpeg"></p>
<p>kubectlå’Œkube-apiserveræ˜¯CSæ¶æ„ï¼Œkubectlæ˜¯æ“ä½œk8sé›†ç¾¤çš„å®¢æˆ·ç«¯ï¼Œkube-apiserveræ˜¯æœåŠ¡ç«¯ã€‚</p>
<p>minikubeæ˜¯åˆ›å»ºäº†ä¸€ä¸ªè™šæ‹Ÿæœº<code>minikube vm</code>ï¼Œç„¶ååœ¨è™šæ‹Ÿæœºé‡Œåˆ›å»ºäº†1ä¸ªå•æœºçš„k8sé›†ç¾¤ï¼Œå¹¶æŠŠé›†ç¾¤éƒ¨ç½²ä¿¡æ¯å†™åˆ°<code>~/.kube/config</code>æ–‡ä»¶ï¼Œå®ƒæ˜¯kubectlé»˜è®¤ä½¿ç”¨çš„é…ç½®æ–‡ä»¶ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[~]$ ls ~&#x2F;.kube&#x2F;config</span><br><span class="line">&#x2F;Users&#x2F;shitaibin&#x2F;.kube&#x2F;config</span><br><span class="line">[~]$ cat ~&#x2F;.kube&#x2F;config</span><br><span class="line">apiVersion: v1</span><br><span class="line">clusters:</span><br><span class="line">- cluster:</span><br><span class="line">    certificate-authority: &#x2F;Users&#x2F;shitaibin&#x2F;.minikube&#x2F;ca.crt</span><br><span class="line">    server: https:&#x2F;&#x2F;192.168.99.103:8443</span><br><span class="line">  name: minikube</span><br><span class="line">contexts:</span><br><span class="line">- context:</span><br><span class="line">    cluster: minikube</span><br><span class="line">    user: minikube</span><br><span class="line">  name: minikube</span><br><span class="line">current-context: minikube</span><br><span class="line">kind: Config</span><br><span class="line">preferences: &#123;&#125;</span><br><span class="line">users:</span><br><span class="line">- name: minikube</span><br><span class="line">  user:</span><br><span class="line">    client-certificate: &#x2F;Users&#x2F;shitaibin&#x2F;.minikube&#x2F;profiles&#x2F;minikube&#x2F;client.crt</span><br><span class="line">    client-key: &#x2F;Users&#x2F;shitaibin&#x2F;.minikube&#x2F;profiles&#x2F;minikube&#x2F;client.key</span><br></pre></td></tr></table></figure>

<p>æ–‡ä»¶å†…å®¹ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>kubectl config view</code> å‘½ä»¤æŸ¥çœ‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[~]$ kubectl config view</span><br><span class="line">apiVersion: v1</span><br><span class="line">clusters:</span><br><span class="line">- cluster:</span><br><span class="line">    certificate-authority: &#x2F;Users&#x2F;shitaibin&#x2F;.minikube&#x2F;ca.crt</span><br><span class="line">    server: https:&#x2F;&#x2F;192.168.99.103:8443</span><br><span class="line">  name: minikube</span><br><span class="line">contexts:</span><br><span class="line">- context:</span><br><span class="line">    cluster: minikube</span><br><span class="line">    user: minikube</span><br><span class="line">  name: minikube</span><br><span class="line">current-context: minikube</span><br><span class="line">kind: Config</span><br><span class="line">preferences: &#123;&#125;</span><br><span class="line">users:</span><br><span class="line">- name: minikube</span><br><span class="line">  user:</span><br><span class="line">    client-certificate: &#x2F;Users&#x2F;shitaibin&#x2F;.minikube&#x2F;profiles&#x2F;minikube&#x2F;client.crt</span><br><span class="line">    client-key: &#x2F;Users&#x2F;shitaibin&#x2F;.minikube&#x2F;profiles&#x2F;minikube&#x2F;client.key</span><br><span class="line">[~]$</span><br></pre></td></tr></table></figure>

<h2 id="å®‰è£…è½¯ä»¶"><a href="#å®‰è£…è½¯ä»¶" class="headerlink" title="å®‰è£…è½¯ä»¶"></a>å®‰è£…è½¯ä»¶</h2><ol>
<li><p>å®‰è£…minikubeï¼Œ1åˆ†é’Ÿï¼Œå¦‚æœæä¾›çš„å‘½ä»¤è¡Œä¸‹è½½ä¸ä¸‹æ¥ï¼Œå°±æµè§ˆå™¨ä¸‹è½½ä¸‹æ¥ï¼Œæ”¾åˆ°å¢åŠ å¯æ‰§è¡Œï¼Œç„¶åæ”¾åˆ°binç›®å½•å³å¯ï¼š<br><a target="_blank" rel="noopener" href="https://yq.aliyun.com/articles/691500">https://yq.aliyun.com/articles/691500</a></p>
</li>
<li><p>centoså®‰è£…virtualboxï¼Œ2åˆ†é’Ÿå®‰è£…å®Œæˆ:<br><a target="_blank" rel="noopener" href="https://wiki.centos.org/zh/HowTos/Virtualization/VirtualBox">https://wiki.centos.org/zh/HowTos/Virtualization/VirtualBox</a></p>
</li>
<li><p>å®‰è£…kubectlï¼š<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/yuanjunlai141/article/details/79469071">https://blog.csdn.net/yuanjunlai141/article/details/79469071</a></p>
</li>
</ol>
<h2 id="é¦–æ¬¡å¯åŠ¨"><a href="#é¦–æ¬¡å¯åŠ¨" class="headerlink" title="é¦–æ¬¡å¯åŠ¨"></a>é¦–æ¬¡å¯åŠ¨</h2><p>å¯åŠ¨å‘½ä»¤</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">minikube start --image-mirror-country cn \</span><br><span class="line">    --iso-url&#x3D;https:&#x2F;&#x2F;kubernetes.oss-cn-hangzhou.aliyuncs.com&#x2F;minikube&#x2F;iso&#x2F;minikube-v1.7.3.iso \</span><br><span class="line">    --registry-mirror&#x3D;&quot;https:&#x2F;&#x2F;a90tkz28.mirror.aliyuncs.com&quot; \</span><br><span class="line">    --image-repository&#x3D;&quot;registry.cn-hangzhou.aliyuncs.com&#x2F;google_containers&quot; \</span><br><span class="line">    --kubernetes-version&#x3D;v1.18.3</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨minikubeå¯ä»¥æŸ¥çœ‹å¸®åŠ©flagå¸®åŠ©ä¿¡æ¯ï¼š</p>
<ul>
<li><code>--image-mirror-country</code>: éœ€è¦ä½¿ç”¨çš„é•œåƒé•œåƒçš„å›½å®¶/åœ°åŒºä»£ç ã€‚ç•™ç©ºä»¥ä½¿ç”¨å…¨çƒä»£ç ã€‚å¯¹äºä¸­å›½å¤§é™†ç”¨æˆ·ï¼Œè¯·å°†å…¶è®¾ç½®ä¸º<br>cn</li>
<li><code>--registry-mirror</code>: ä¼ é€’ç»™ Docker å®ˆæŠ¤è¿›ç¨‹çš„æ³¨å†Œè¡¨é•œåƒã€‚æ•ˆæœæœ€å¥½çš„é•œåƒåŠ é€Ÿå™¨ï¼š<code>--registry-mirror=&quot;https://a90tkz28.mirror.aliyuncs.com&quot;</code> ã€‚ä½¿ç”¨åŠ é€Ÿå™¨çš„åŸç†æ˜¯ï¼Œdocker deamonä¼šå…ˆå»åŠ é€Ÿå™¨å¯»æ‰¾é•œåƒï¼Œå¦‚æœæ‰¾ä¸åˆ°æ‰ä»dockerå®˜æ–¹ä»“åº“æ‹‰é•œåƒã€‚å¦‚æœæŒ‡å®šæ‹‰æŸä¸ªé•œåƒä»“åº“çš„é•œåƒï¼Œé•œåƒåŠ é€Ÿå™¨æ˜¯ç”¨ä¸ä¸Šçš„ã€‚</li>
<li><code>--image-repository</code> : å¦‚æœä¸èƒ½ä»gcr.ioæ‹‰é•œåƒï¼Œé…ç½®minikubeä¸­dockeræ‹‰é•œåƒçš„åœ°æ–¹</li>
<li><code>--kubernetes-version</code>ï¼š æŒ‡å®šè¦éƒ¨ç½²çš„k8sç‰ˆæœ¬ï¼Œå¯ä»¥çœç•¥</li>
</ul>
<p>minikubeå†…æ‹‰ä¸åˆ°é•œåƒçš„æŠ¥é”™:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl describe pod</span><br><span class="line">  Type     Reason     Age                    From               Message</span><br><span class="line">  ----     ------     ----                   ----               -------</span><br><span class="line">  Warning  Failed     2m59s (x4 over 4m36s)  kubelet, minikube  Failed to pull image &quot;kubeguide&#x2F;redis-master&quot;: rpc error: code &#x3D; Unknown desc &#x3D; Error response from daemon: Get https:&#x2F;&#x2F;registry-1.docker.io&#x2F;v2&#x2F;: proxyconnect tcp: dial tcp 192.168.0.104:1087: connect: connection refused</span><br></pre></td></tr></table></figure>

<p>å¯åŠ¨æ—¥å¿—ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ minikube start --image-mirror-country cn \</span><br><span class="line">    --iso-url&#x3D;https:&#x2F;&#x2F;kubernetes.oss-cn-hangzhou.aliyuncs.com&#x2F;minikube&#x2F;iso&#x2F;minikube-v1.7.3.iso \</span><br><span class="line">    --registry-mirror&#x3D;&quot;https:&#x2F;&#x2F;a90tkz28.mirror.aliyuncs.com&quot; \</span><br><span class="line">    --image-repository&#x3D;&quot;registry.cn-hangzhou.aliyuncs.com&#x2F;google_containers&quot;</span><br><span class="line">ğŸ˜„  Darwin 10.15.3 ä¸Šçš„ minikube v1.12.3</span><br><span class="line">âœ¨  æ ¹æ®ç”¨æˆ·é…ç½®ä½¿ç”¨ virtualbox é©±åŠ¨ç¨‹åº</span><br><span class="line">âœ…  æ­£åœ¨ä½¿ç”¨é•œåƒå­˜å‚¨åº“ registry.cn-hangzhou.aliyuncs.com&#x2F;google_containers</span><br><span class="line">ğŸ‘  Starting control plane node minikube in cluster minikube</span><br><span class="line">ğŸ”¥  Creating virtualbox VM (CPUs&#x3D;2, Memory&#x3D;4000MB, Disk&#x3D;20000MB) ...</span><br><span class="line">ğŸ’¡  Existing disk is missing new features (lz4). To upgrade, run &#39;minikube delete&#39;</span><br><span class="line">ğŸ³  æ­£åœ¨ Docker 19.03.6 ä¸­å‡†å¤‡ Kubernetes v1.18.3â€¦</span><br><span class="line">ğŸ”  Verifying Kubernetes components...</span><br><span class="line">ğŸŒŸ  Enabled addons: default-storageclass, storage-provisioner</span><br><span class="line">ğŸ„  å®Œæˆï¼kubectl å·²ç»é…ç½®è‡³ &quot;minikube&quot;</span><br></pre></td></tr></table></figure>

<p>åšå“ªäº›äº‹ï¼Ÿ</p>
<ol>
<li>åˆ›å»ºè™šæ‹Ÿæœºâ€minikubeâ€</li>
<li>ç”Ÿæˆkubectlä½¿ç”¨çš„é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨è¯¥é…ç½®è¿æ¥é›†ç¾¤ï¼š~/.kube/config</li>
<li>åœ¨è™šæ‹Ÿæœºé‡Œçš„å®¹å™¨ä¸Šå¯åŠ¨k8s</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">$ minikube ssh</span><br><span class="line">                         _             _</span><br><span class="line">            _         _ ( )           ( )</span><br><span class="line">  ___ ___  (_)  ___  (_)| |&#x2F;&#39;)  _   _ | |_      __</span><br><span class="line">&#x2F;&#39; _ &#96; _ &#96;\| |&#x2F;&#39; _ &#96;\| || , &lt;  ( ) ( )| &#39;_&#96;\  &#x2F;&#39;__&#96;\</span><br><span class="line">| ( ) ( ) || || ( ) || || |\&#96;\ | (_) || |_) )(  ___&#x2F;</span><br><span class="line">(_) (_) (_)(_)(_) (_)(_)(_) (_)&#96;\___&#x2F;&#39;(_,__&#x2F;&#39;&#96;\____)</span><br><span class="line"></span><br><span class="line">$</span><br><span class="line">$ docker info</span><br><span class="line">Client:</span><br><span class="line"> Debug Mode: false</span><br><span class="line"></span><br><span class="line">Server:</span><br><span class="line"> Containers: 18</span><br><span class="line">  Running: 15</span><br><span class="line">  Paused: 0</span><br><span class="line">  Stopped: 3</span><br><span class="line"> Images: 11</span><br><span class="line"> Server Version: 19.03.6</span><br><span class="line"> Storage Driver: overlay2</span><br><span class="line">  Backing Filesystem: extfs</span><br><span class="line">  Supports d_type: true</span><br><span class="line">  Native Overlay Diff: true</span><br><span class="line"> Logging Driver: json-file</span><br><span class="line"> Cgroup Driver: cgroupfs</span><br><span class="line"> Plugins:</span><br><span class="line">  Volume: local</span><br><span class="line">  Network: bridge host ipvlan macvlan null overlay</span><br><span class="line">  Log: awslogs fluentd gcplogs gelf journald json-file local logentries splunk syslog</span><br><span class="line"> Swarm: inactive</span><br><span class="line"> Runtimes: runc</span><br><span class="line"> Default Runtime: runc</span><br><span class="line"> Init Binary: docker-init</span><br><span class="line"> containerd version: 35bd7a5f69c13e1563af8a93431411cd9ecf5021</span><br><span class="line"> runc version: dc9208a3303feef5b3839f4323d9beb36df0a9dd</span><br><span class="line"> init version: fec3683</span><br><span class="line"> Security Options:</span><br><span class="line">  seccomp</span><br><span class="line">   Profile: default</span><br><span class="line"> Kernel Version: 4.19.94</span><br><span class="line"> Operating System: Buildroot 2019.02.9</span><br><span class="line"> OSType: linux</span><br><span class="line"> Architecture: x86_64</span><br><span class="line"> CPUs: 2</span><br><span class="line"> Total Memory: 3.754GiB</span><br><span class="line"> Name: minikube</span><br><span class="line"> ID: 6GOT:L6SH:NPBW:ZM44:PVKY:LSEZ:MXW7:LWOB:GB4N:CNXU:S6NJ:KASG</span><br><span class="line"> Docker Root Dir: &#x2F;var&#x2F;lib&#x2F;docker</span><br><span class="line"> Debug Mode: false</span><br><span class="line"> Registry: https:&#x2F;&#x2F;index.docker.io&#x2F;v1&#x2F;</span><br><span class="line"> Labels:</span><br><span class="line">  provider&#x3D;virtualbox</span><br><span class="line"> Experimental: false</span><br><span class="line"> Insecure Registries:</span><br><span class="line">  10.96.0.0&#x2F;12</span><br><span class="line">  127.0.0.0&#x2F;8</span><br><span class="line"> Registry Mirrors:</span><br><span class="line">  https:&#x2F;&#x2F;a90tkz28.mirror.aliyuncs.com&#x2F;</span><br><span class="line"> Live Restore Enabled: false</span><br><span class="line"> Product License: Community Engine</span><br><span class="line"></span><br><span class="line">$ exit</span><br><span class="line">logout</span><br></pre></td></tr></table></figure>

<p>Registry Mirrorså¯¹åº”çš„æ˜¯é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿï¼ŒHTTP proxyä¹Ÿé…ç½®ä¸Šäº†ï¼Œå¦‚æœå¯åŠ¨åï¼Œå‘ç°æ²¡æœ‰æ”¹å˜ï¼Œéœ€è¦åˆ é™¤è¿‡å»åˆ›å»ºçš„minikubeï¼Œå…¨éƒ¨æ¸…ç†ä¸€éã€‚</p>
<h2 id="minikubeå¸¸ç”¨å‘½ä»¤"><a href="#minikubeå¸¸ç”¨å‘½ä»¤" class="headerlink" title="minikubeå¸¸ç”¨å‘½ä»¤"></a>minikubeå¸¸ç”¨å‘½ä»¤</h2><ul>
<li>é›†ç¾¤çŠ¶æ€ï¼š minikube status</li>
<li>æš‚åœå’Œæ¢å¤é›†ç¾¤ï¼Œä¸ç”¨çš„æ—¶å€™æŠŠå®ƒæš‚åœæ‰ï¼ŒèŠ‚çº¦ä¸»æœºçš„CPUå’Œå†…å­˜ï¼š minikube pauseï¼Œ minikube unpause</li>
<li>åœæ­¢é›†ç¾¤ï¼š minikube stop</li>
<li>åˆ é™¤é›†ç¾¤ï¼Œé‡åˆ°é—®é¢˜æ—¶ï¼Œæ¸…ç†ä¸€æ³¢æ•°æ®ï¼š minikube delete</li>
<li>æŸ¥çœ‹é›†ç¾¤IPï¼Œkubectlå°±æ˜¯è¿è¿™ä¸ªIPï¼š minikube ip</li>
<li>è¿›å…¥minikubeè™šæ‹Ÿæœºï¼Œæ•´ä¸ªk8sé›†ç¾¤è·‘åœ¨è¿™é‡Œé¢ï¼š minikube ssh</li>
</ul>
<h2 id="kubectlè‡ªåŠ¨è¡¥å…¨"><a href="#kubectlè‡ªåŠ¨è¡¥å…¨" class="headerlink" title="kubectlè‡ªåŠ¨è¡¥å…¨"></a>kubectlè‡ªåŠ¨è¡¥å…¨</h2><p>zshåœ¨é…ç½®æ–‡ä»¶ <code>~/.zshrc</code> ä¸­å¢åŠ ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">source &lt;(kubectl completion zsh)  # åœ¨ zsh ä¸­è®¾ç½®å½“å‰ shell çš„è‡ªåŠ¨è¡¥å…¨</span><br><span class="line">echo &quot;if [ $commands[kubectl] ]; then source &lt;(kubectl completion zsh); fi&quot; &gt;&gt; ~&#x2F;.zshrc # åœ¨æ‚¨çš„ zsh shell ä¸­æ°¸ä¹…çš„æ·»åŠ è‡ªåŠ¨è¡¥å…¨</span><br></pre></td></tr></table></figure>

<p>bash åœ¨ <code>~/.bashrc</code> ä¸­å¢åŠ :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">source &lt;(kubectl completion bash) # åœ¨ bash ä¸­è®¾ç½®å½“å‰ shell çš„è‡ªåŠ¨è¡¥å…¨ï¼Œè¦å…ˆå®‰è£… bash-completion åŒ…ã€‚</span><br><span class="line">echo &quot;source &lt;(kubectl completion bash)&quot; &gt;&gt; ~&#x2F;.bashrc # åœ¨æ‚¨çš„ bash shell ä¸­æ°¸ä¹…çš„æ·»åŠ è‡ªåŠ¨è¡¥å…¨</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://lessisbetter.site/2020/08/27/sync-code-to-server-with-sftp-in-vscode/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://github.com/Shitaibin/shitaibin.github.io/blob/hexo_resource/images/gzh-qrcode-logo-small.png">
      <meta itemprop="name" content="å¤§å½¬">
      <meta itemprop="description" content="äº‘åŸç”Ÿã€Goè¯­è¨€ã€åŒºå—é“¾">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Goè¯­è¨€å……ç”µç«™">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/27/sync-code-to-server-with-sftp-in-vscode/" class="post-title-link" itemprop="url">VSCodeåˆ©ç”¨SFTPä¸Šä¼ ä»£ç åˆ°æœåŠ¡å™¨</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2020-08-27 20:24:00" itemprop="dateCreated datePublished" datetime="2020-08-27T20:24:00+08:00">2020-08-27</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">æ›´æ–°äº</span>
        <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-12-13 14:18:43" itemprop="dateModified" datetime="2020-12-13T14:18:43+08:00">2020-12-13</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>VSCodeå·²ç»æ”¯æŒè¿œç¨‹å¼€å‘ï¼Œå¯ä»¥æŠŠä»£ç è‡ªåŠ¨ä»æœ¬åœ°å’ŒæœåŠ¡å™¨è¿›è¡ŒåŒæ­¥ã€‚</p>
<p>ä¸ºäº†æŸäº›å®éªŒæäº†ä¸€æ¡Ubuntu 14.04çš„æœåŠ¡å™¨ï¼Œç»“æœVSCodeè¯´è¿œç¨‹æœåŠ¡å™¨ä¸æ”¯æŒï¼Œå°±åªèƒ½å¦è°‹å®ƒè·¯äº†ï¼Œåˆ©ç”¨SFTPå®ç°æœ¬åœ°å’ŒæœåŠ¡å™¨ç«¯çš„ä»£ç åŒæ­¥ã€‚</p>
<h2 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><ol>
<li>VSCodeåº”ç”¨å¸‚åœºå®‰è£…SFTPæ’ä»¶</li>
<li>åœ¨é¡¹ç›®ç›®å½•ä¸‹å»ºç«‹SFTPçš„é…ç½®æ–‡ä»¶ï¼š<code>.vscode/sftp.json</code>ï¼Œå†…å®¹å¦‚ä¸‹</li>
</ol>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;root&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;host&quot;</span>: <span class="string">&quot;192.168.9.xxx&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;protocol&quot;</span>: <span class="string">&quot;sftp&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;port&quot;</span>: <span class="number">22</span>,</span><br><span class="line">    <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;centos&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;privateKeyPath&quot;</span>: <span class="string">&quot;/Users/shitaibin/.ssh/id_xxx&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;remotePath&quot;</span>: <span class="string">&quot;/home/centos/workspace/docker/notes&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;uploadOnSave&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">&quot;ignore&quot;</span>: [<span class="string">&quot;.vscode&quot;</span>, <span class="string">&quot;.git&quot;</span>, <span class="string">&quot;.DS_Store&quot;</span>, <span class="string">&quot;node_modules&quot;</span>, <span class="string">&quot;vendor&quot;</span>],</span><br><span class="line">    <span class="attr">&quot;localPath&quot;</span>:<span class="string">&quot;.&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç™»å½•æœåŠ¡å™¨å¯ä»¥ä½¿ç”¨å¯†ç æˆ–è€…ç§é’¥ï¼Œä¸Šé¢æ–‡ä»¶çš„ç¤ºä¾‹ä½¿ç”¨ç§é’¥ï¼Œå¦‚æœä½¿ç”¨å¯†ç ï¼Œå¢åŠ ä¸€é¡¹<code>password</code>å³å¯ã€‚</p>
<p><code>uploadOnSave</code>é…ç½®é¡¹è®¾ç½®ä¸ºtrueï¼Œèƒ½å¤Ÿç¡®ä¿æ–‡ä»¶ä¿å­˜æ—¶ï¼Œè‡ªåŠ¨ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œæ— éœ€æ‰‹åŠ¨ä¸Šä¼ ã€‚</p>
<ol start="3">
<li><p>åˆæ¬¡ä¸Šä¼ åˆ°æœåŠ¡å™¨</p>
<p> a. Ctrl + Shift + Pï¼Œè¾“å…¥<code>SFTP</code>ï¼Œé€‰æ‹©<code>Sync Local -&gt; Remote</code>å³å¯<br> b. VSCodeåº•éƒ¨çŠ¶æ€æ ï¼Œä¼šæ˜¾ç¤ºSFTPï¼Œå¦‚æœåœ¨åŠ¨æ€å˜åŒ–ï¼Œè¯´æ˜åœ¨ä¸Šä¼ æ–‡ä»¶</p>
</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://lessisbetter.site/2020/07/29/go-time-date-timestamp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://github.com/Shitaibin/shitaibin.github.io/blob/hexo_resource/images/gzh-qrcode-logo-small.png">
      <meta itemprop="name" content="å¤§å½¬">
      <meta itemprop="description" content="äº‘åŸç”Ÿã€Goè¯­è¨€ã€åŒºå—é“¾">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Goè¯­è¨€å……ç”µç«™">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/07/29/go-time-date-timestamp/" class="post-title-link" itemprop="url">Goè¯­è¨€æ—¥æœŸå’Œæ—¶é—´æˆ³è½¬æ¢</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2020-07-29 19:48:59" itemprop="dateCreated datePublished" datetime="2020-07-29T19:48:59+08:00">2020-07-29</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">æ›´æ–°äº</span>
        <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-12-13 16:11:59" itemprop="dateModified" datetime="2020-12-13T16:11:59+08:00">2020-12-13</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>å­—ç¬¦ä¸²æ ¼å¼æ—¥æœŸã€time.Timeç±»å‹ã€æ•´å½¢æ—¶é—´æˆ³ä¸‰è€…ä¹‹é—´çš„è½¬æ¢å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://img.lessisbetter.site/2020-07-go-time-date-transform.png"></p>
<p>æœ‰2ç‚¹è¦æ³¨æ„ï¼š</p>
<ol>
<li>å­—ç¬¦ä¸²æ—¥æœŸå’Œæ—¶é—´æˆ³ä¹‹é—´ä¸èƒ½ç›´æ¥è½¬æ¢ï¼Œéœ€è¦é€šè¿‡time.Timeå®Œæˆã€‚</li>
<li>æ¶‰åŠå­—ç¬¦ä¸²æ—¥æœŸçš„æ—¶å€™ï¼Œå­—ç¬¦ä¸²æ—¥æœŸæ ¼å¼ä¸€å®šè¦ä»¥Goè¯ç”Ÿçš„æ—¶é—´ä¸ºåŸºå‡†ï¼Œè€Œä¸æ˜¯éšæ„çš„æ—¶é—´ï¼Œå¦åˆ™ä¼šå¯¼è‡´æ—¶é—´è½¬æ¢ä¸æ­£ç¡®ã€‚æ‰€ä»¥ï¼Œä»¥ä¸‹Demoä¸­çš„æ—¥æœŸæ ¼å¼æ˜¯é€šç”¨çš„ã€‚</li>
<li>å­—ç¬¦ä¸²æ—¥æœŸæ ¼å¼è¦ä¸çœŸå®çš„æ—¥æœŸæ ¼å¼å®Œå…¨åŒ¹é…ï¼Œå¦åˆ™ä¼šè§£ææ—¶é—´ä¸æ­£ç¡®ã€‚æ¯”å¦‚è®¾ç½®çš„æ ¼å¼ä¸º<code>2006-01-02</code>ï¼Œå®é™…æ—¥æœŸæ ¼å¼ä¸º<code>2006-1-2</code>æ—¶ä¼šè§£æé”™è¯¯ã€‚</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Date2Time</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;&gt;&gt; Date2Time&quot;</span>)</span><br><span class="line">	<span class="keyword">defer</span> fmt.Println(<span class="string">&quot;&lt;&lt; Date2Time&quot;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ä¸€å®šè¦ä»¥Goè¯ç”Ÿçš„æ—¶é—´ä¸ºåŸºå‡†</span></span><br><span class="line">	<span class="comment">// 2006å¹´1æœˆ2å·ï¼ŒMSTæ—¶åŒºï¼Œä¸‹åˆ3:04åˆ†ä¸ºåŸºå‡†</span></span><br><span class="line">	<span class="keyword">const</span> dateFormat = <span class="string">&quot;Jan 2, 2006 at 3:04pm (MST)&quot;</span></span><br><span class="line">	t, _ := time.Parse(dateFormat, <span class="string">&quot;May 20, 2020 at 0:00am (UTC)&quot;</span>)</span><br><span class="line">	fmt.Println(t)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">const</span> shortForm = <span class="string">&quot;2006-Jan-02&quot;</span></span><br><span class="line">	t, _ = time.Parse(shortForm, <span class="string">&quot;2020-May-20&quot;</span>)</span><br><span class="line">	fmt.Println(t)</span><br><span class="line"></span><br><span class="line">	t, _ = time.Parse(<span class="string">&quot;01/02/2006&quot;</span>, <span class="string">&quot;05/20/2020&quot;</span>)</span><br><span class="line">	fmt.Println(t)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Time2Date</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;&gt;&gt; Time2Date&quot;</span>)</span><br><span class="line">	<span class="keyword">defer</span> fmt.Println(<span class="string">&quot;&lt;&lt; Time2Date&quot;</span>)</span><br><span class="line"></span><br><span class="line">	tm := time.Now()</span><br><span class="line">	fmt.Println(tm.Format(<span class="string">&quot;2006-01-02 03:04:05 PM&quot;</span>))</span><br><span class="line">	fmt.Println(tm.Format(<span class="string">&quot;2006-1-2 03:04:05 PM&quot;</span>))</span><br><span class="line">	fmt.Println(tm.Format(<span class="string">&quot;2006-Jan-02 03:04:05 PM&quot;</span>))</span><br><span class="line">	fmt.Println(tm.Format(<span class="string">&quot;02/01/2006 03:04:05 PM&quot;</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Timestamp2Time</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;&gt;&gt; Timestamp2Time&quot;</span>)</span><br><span class="line">	<span class="keyword">defer</span> fmt.Println(<span class="string">&quot;&lt;&lt; Timestamp2Time&quot;</span>)</span><br><span class="line"></span><br><span class="line">	ts := <span class="keyword">int64</span>(<span class="number">1595900001</span>)</span><br><span class="line">	tm := time.Unix(ts, <span class="number">0</span>)</span><br><span class="line">	fmt.Println(tm)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Time2Timestamp</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;&gt;&gt; Time2Timestamp&quot;</span>)</span><br><span class="line">	<span class="keyword">defer</span> fmt.Println(<span class="string">&quot;&lt;&lt; Time2Timestamp&quot;</span>)</span><br><span class="line"></span><br><span class="line">	tm := time.Now()</span><br><span class="line">	ts := tm.Unix()</span><br><span class="line">	fmt.Println(ts)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	Date2Time()</span><br><span class="line">	Time2Date()</span><br><span class="line">	Timestamp2Time()</span><br><span class="line">	Time2Timestamp()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt; Date2Time</span><br><span class="line">2020-05-20 00:00:00 +0000 UTC</span><br><span class="line">2020-05-20 00:00:00 +0000 UTC</span><br><span class="line">2020-05-20 00:00:00 +0000 UTC</span><br><span class="line">&lt;&lt; Date2Time</span><br><span class="line">&gt;&gt; Time2Date</span><br><span class="line">2020-07-28 09:35:46 AM</span><br><span class="line">2020-7-28 09:35:46 AM</span><br><span class="line">2020-Jul-28 09:35:46 AM</span><br><span class="line">28&#x2F;07&#x2F;2020 09:35:46 AM</span><br><span class="line">&lt;&lt; Time2Date</span><br><span class="line">&gt;&gt; Timestamp2Time</span><br><span class="line">2020-07-28 09:33:21 +0800 CST</span><br><span class="line">&lt;&lt; Timestamp2Time</span><br><span class="line">&gt;&gt; Time2Timestamp</span><br><span class="line">1595900146</span><br><span class="line">&lt;&lt; Time2Timestamp</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://lessisbetter.site/2020/07/28/about-ssh/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://github.com/Shitaibin/shitaibin.github.io/blob/hexo_resource/images/gzh-qrcode-logo-small.png">
      <meta itemprop="name" content="å¤§å½¬">
      <meta itemprop="description" content="äº‘åŸç”Ÿã€Goè¯­è¨€ã€åŒºå—é“¾">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Goè¯­è¨€å……ç”µç«™">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/07/28/about-ssh/" class="post-title-link" itemprop="url">SSHå¸¸ç”¨å‘½ä»¤å’Œé…ç½®</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2020-07-28 21:11:15" itemprop="dateCreated datePublished" datetime="2020-07-28T21:11:15+08:00">2020-07-28</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">æ›´æ–°äº</span>
        <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-12-13 14:18:43" itemprop="dateModified" datetime="2020-12-13T14:18:43+08:00">2020-12-13</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="ç”ŸæˆSSHå¯†é’¥"><a href="#ç”ŸæˆSSHå¯†é’¥" class="headerlink" title="ç”ŸæˆSSHå¯†é’¥"></a>ç”ŸæˆSSHå¯†é’¥</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -f ~/.ssh/id_rsa -C <span class="string">&quot;temp user&quot;</span> -N <span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>-tï¼šæŒ‡å®šåŠ å¯†ç®—æ³•<br>-fï¼šæŒ‡å®šè·¯å¾„<br>-Cï¼šæ³¨é‡Šï¼Œå¯ä»¥å¡«å†™ç”¨æˆ·åæˆ–é‚®ç®±<br>-Nï¼šå¯†ç </p>
<p>æŒ‡å®šä»¥ä¸Š<code>fã€Cã€N</code>è¿™3ä¸ªå‚æ•°ï¼Œå¯ä»¥é¿å…äº¤äº’å¼é—®ç­”ï¼Œå¿«é€Ÿç”Ÿæˆå¯†é’¥ï¼Œåœ¨è„šæœ¬ä¸­ä½¿ç”¨å¾ˆæ–¹ä¾¿ã€‚</p>
<h2 id="SSHå®¢æˆ·ç«¯é…ç½®æ–‡ä»¶"><a href="#SSHå®¢æˆ·ç«¯é…ç½®æ–‡ä»¶" class="headerlink" title="SSHå®¢æˆ·ç«¯é…ç½®æ–‡ä»¶"></a>SSHå®¢æˆ·ç«¯é…ç½®æ–‡ä»¶</h2><p><code>~/.ssh/config</code>æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># Read more about SSH config files: https:&#x2F;&#x2F;linux.die.net&#x2F;man&#x2F;5&#x2F;ssh_config</span><br><span class="line">Host ä¸ªäººVM</span><br><span class="line">    HostName 192.168.9.137</span><br><span class="line">    User centos</span><br><span class="line"></span><br><span class="line">Host é˜¿é‡Œäº‘</span><br><span class="line">    HostName 139.224.105.10</span><br><span class="line">    User root</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">Host è…¾è®¯äº‘</span><br><span class="line">    HostName 140.143.6.185</span><br><span class="line">    User root</span><br><span class="line">    Port 22</span><br><span class="line">    IdentityFile ~&#x2F;.ssh&#x2F;id_rsa_tencent</span><br></pre></td></tr></table></figure>

<ul>
<li>Hostï¼šè‡ªå®šä¹‰å‘½å</li>
<li>HostNameï¼šæœºå™¨IPæˆ–è€…åŸŸå</li>
<li>Userï¼šç™»å½•æœºå™¨çš„ç”¨æˆ·å</li>
<li>Portï¼šç™»å½•æœºå™¨çš„ç«¯å£ï¼Œé»˜è®¤ä¸º22ï¼Œå¯çœç•¥</li>
<li>IdentityFileï¼šç™»å½•æœºå™¨æ—¶ä½¿ç”¨çš„ç§é’¥ï¼Œé»˜è®¤ä¸º<code>~/.ssh/id_rsa</code>ï¼Œå¯çœç•¥ï¼›å½“æŸå°æœºå™¨ä½¿ç”¨å•ç‹¬å¯†é’¥æ—¶ï¼Œå¾ˆæœ‰ç”¨</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://lessisbetter.site/2020/05/05/open-source-license/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://github.com/Shitaibin/shitaibin.github.io/blob/hexo_resource/images/gzh-qrcode-logo-small.png">
      <meta itemprop="name" content="å¤§å½¬">
      <meta itemprop="description" content="äº‘åŸç”Ÿã€Goè¯­è¨€ã€åŒºå—é“¾">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Goè¯­è¨€å……ç”µç«™">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/05/05/open-source-license/" class="post-title-link" itemprop="url">å¦‚ä½•é€‰æ‹©å¼€æºåè®®</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2020-05-05 14:37:26" itemprop="dateCreated datePublished" datetime="2020-05-05T14:37:26+08:00">2020-05-05</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">æ›´æ–°äº</span>
        <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-12-13 16:11:59" itemprop="dateModified" datetime="2020-12-13T16:11:59+08:00">2020-12-13</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>å½“åŸºäºå¼€æºé¡¹ç›®å‘å¸ƒæ–°çš„å¼€æºé¡¹ç›®æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è¯´æ˜é¡¹ç›®æ‰€ä½¿ç”¨çš„Licenseï¼ŒåŒæ ·ä¹Ÿéœ€è¦è€ƒè™‘ä½ åŸºäºå¼€æºé¡¹ç›®æ‰€åšçš„äº‹æƒ…ï¼Œæ˜¯å¦æ»¡è¶³è¯¥é¡¹ç›®çš„Licenseã€‚</p>
<p>ä¸‹é¢è¿™2å¹…å›¾æ‘˜è‡ª <a target="_blank" rel="noopener" href="https://www.zhihu.com/question/28292322">å¼€æºè®¸å¯è¯éƒ½æœ‰ä»€ä¹ˆåŒºåˆ«,ä¸€èˆ¬å¼€æºé¡¹ç›®ç”¨ä»€ä¹ˆè®¸å¯è¯? - çŸ¥ä¹</a>ï¼Œè¶³ä»¥å¸®åŠ©æˆ‘ä»¬åˆ¤æ–­ï¼š</p>
<ol>
<li>è¦åšçš„äº‹æƒ…ï¼Œæ˜¯å¦æ»¡è¶³å¼€æºé¡¹ç›®çš„Licenseã€‚</li>
<li>å¼€æºä¸€ä¸ªé¡¹ç›®ï¼Œè¯¥å¦‚ä½•é€‰æ‹©Licenseã€‚</li>
</ol>
<p><img src="http://img.lessisbetter.site/2020-05-license-choose.jpg"><br>æ¥æºï¼š<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/28292322/answer/656121132">https://www.zhihu.com/question/28292322/answer/656121132</a></p>
<p><img src="http://img.lessisbetter.site/2020-05-license-2.jpg"><br>æ¥æºï¼š<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/28292322/answer/840556759">https://www.zhihu.com/question/28292322/answer/840556759</a><br>ä»å·¦åˆ°å³ï¼Œæ˜¯ä»å®½æ¾åˆ°ä¸¥æ ¼ã€‚</p>
<p>ä¸¾ä¾‹ï¼š</p>
<ol>
<li>ä»¥å¤ªåŠé‡‡Licenseç”¨çš„æ˜¯LGPLv3ï¼Œä¿®æ”¹æºç åå¦‚æœæä¾›ç»™å¤–éƒ¨ä½¿ç”¨å¿…é¡»å¼€æºï¼Œä¸è¦æ±‚æ–°å¢ä»£ç é‡‡ç”¨ç›¸åŒçš„Licenseï¼Œä¹Ÿä¸è¦æ±‚å¯¹æ–°å¢ä»£ç è¿›è¡Œæ–‡æ¡£è¯´æ˜ï¼Œåæ¥æˆ‘ä»¬é¡¹ç›®åŒæ ·é‡‡ç”¨äº†LGPLv3ã€‚</li>
<li>Fabricé‡‡ç”¨Apache 2.0ï¼ŒåŸºäºFabricé¡¹ç›®åŸæœ‰ä»£ç éƒ½å¿…é¡»æ”¾ç½®FabricåŸæœ‰ç‰ˆæƒå£°æ˜ï¼Œä½†å¯ä»¥é€‰æ‹©ä¸å¼€æºã€‚</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://lessisbetter.site/2020/04/12/fabric-bccsp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://github.com/Shitaibin/shitaibin.github.io/blob/hexo_resource/images/gzh-qrcode-logo-small.png">
      <meta itemprop="name" content="å¤§å½¬">
      <meta itemprop="description" content="äº‘åŸç”Ÿã€Goè¯­è¨€ã€åŒºå—é“¾">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Goè¯­è¨€å……ç”µç«™">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/04/12/fabric-bccsp/" class="post-title-link" itemprop="url">Fabric 1.4æºç è§£è¯» 10ï¼šå¯æ‰©å±•å¯†ç æœåŠ¡æä¾›è€…BCCSPï¼Œä»¥åŠå¯æ‰©å±•å›½å¯†</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2020-04-12 14:32:33" itemprop="dateCreated datePublished" datetime="2020-04-12T14:32:33+08:00">2020-04-12</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">æ›´æ–°äº</span>
        <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-12-13 16:11:59" itemprop="dateModified" datetime="2020-12-13T16:11:59+08:00">2020-12-13</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="åºè¨€"><a href="#åºè¨€" class="headerlink" title="åºè¨€"></a>åºè¨€</h2><p>å¯†ç å­¦æ˜¯å½“ä»£æ•°å­—ä¿¡æ¯åŒ–æ—¶ä»£çš„åŸºç¡€æŠ€æœ¯ï¼Œæ²¡æœ‰å¯†ç å­¦ï¼Œç½‘ç»œä¸Šçš„ä¼ è¾“ä¿¡æ¯çš„å¯é æ€§å°±æ— æ³•ä¿è¯ï¼Œæ¯”å¦‚ä½ è¾“å…¥çš„å¯†ç ä¼šè¢«çªƒå–ï¼Œä½ å­˜åœ¨ç½‘ç»œä¸Šçš„ç…§ç‰‡ã€æ–‡æ¡£å¦‚æœæ²¡æœ‰åŠ å¯†ï¼Œå°±æœ‰å¯èƒ½æ³„éœ²ã€‚</p>
<p>å¯†ç å­¦ä¹Ÿæ˜¯åŒºå—é“¾çš„ä¸€é¡¹åŸºç¡€æŠ€æœ¯ï¼Œä½¿ç”¨å¯†ç å­¦å®ç°åŒºå—é“¾ä¸­çš„ï¼šèº«ä»½éªŒè¯ã€æ•°æ®å¯ä¿¡ã€æƒé™ç®¡ç†ã€é›¶çŸ¥è¯†è¯æ˜ã€å¯ä¿¡è®¡ç®—ç­‰ç­‰ã€‚</p>
<p>Fabricæä¾›äº†æ¨¡å—åŒ–çš„ã€å¯æ’æ‹”çš„å¯†ç æœåŠ¡ï¼Œè¯¥æœåŠ¡ç”±<code>bccsp</code>æ¨¡å—æä¾›ï¼Œæœ¬æ–‡å°±è°ˆä¸€ä¸‹BCCSPæ’ä»¶åŒ–è®¾è®¡ï¼Œå¦å¤–Fabricå›½å¯†åŒ–ä¹Ÿæ˜¯æœ€è¿‘2å¹´å¿…åšçš„äº‹æƒ…ï¼Œæ‰€ä»¥åŒæ—¶ä»‹ç»å®ç°å¯æ‰©å±•å›½å¯†çš„æ€è·¯ï¼Œæœ€åä»‹ç»ä¸€ä¸‹Hyperledgerç¤¾åŒºå¯¹Fabricæ”¯æŒå›½å¯†çš„å¼€å‘ã€‚</p>
<h2 id="BCCSPä»‹ç»"><a href="#BCCSPä»‹ç»" class="headerlink" title="BCCSPä»‹ç»"></a>BCCSPä»‹ç»</h2><p>BCCSPæ˜¯Block Chain Crypto Service Providerçš„ç¼©å†™ã€‚</p>
<p><code>bccsp</code>æ¨¡å—å®ƒä¸ºFabricçš„ä¸Šå±‚æ¨¡å—æä¾›å¯†ç å­¦æœåŠ¡ï¼Œå®ƒåŒ…å«çš„å…·ä½“åŠŸèƒ½æœ‰ï¼šå¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†çš„å¯†é’¥ç”Ÿæˆã€å¯¼å¦‚ã€å¯¼å‡ºï¼Œæ•°å­—ç­¾åå’ŒéªŒè¯ï¼Œå¯¹ç§°åŠ å¯†å’Œè§£å¯†ã€æ‘˜è¦è®¡ç®—ã€‚</p>
<p><code>bccsp</code>æ¨¡å—ä¸ºäº†å¯†ç æœåŠ¡çš„æ‰©å±•æ€§ï¼Œå®šä¹‰äº†<code>BCCSP</code>æ¥å£ï¼Œä¸Šå±‚æ¨¡å—è°ƒç”¨<code>BCCSP</code>æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•ï¼Œè€Œä¸ç›´æ¥è°ƒç”¨å…·ä½“çš„å®ç°å‡½æ•°ï¼Œå®ç°å’Œå…·ä½“å¯†ç å­¦å®ç°çš„è§£è€¦ï¼Œå½“<code>bccsp</code>ä½¿ç”¨ä¸åŒå¯†ç å­¦å®ç°æ—¶ï¼Œä¸Šå±‚æ¨¡å—æ— éœ€ä¿®æ”¹ï¼Œè¿™ç§è§£è€¦æ˜¯é€šè¿‡<strong>ä¾èµ–åè½¬</strong>å®ç°çš„ã€‚</p>
<p>bccspæ¨¡å—ä¸­å½“å‰æœ‰2ç§å¯†ç å®ç°ï¼Œå®ƒä»¬éƒ½æ˜¯bccspä¸­çš„å¯†ç å­¦æ’ä»¶ï¼šSWå’ŒPKCS11ï¼ŒSWä»£è¡¨çš„æ˜¯å›½é™…æ ‡å‡†åŠ å¯†çš„è½¯å®ç°ï¼ŒSWæ˜¯softwareçš„ç¼©å†™ï¼ŒPKCS11ä»£æŒ‡ç¡¬å®ç°ã€‚</p>
<p><img src="http://img.lessisbetter.site/2020-04-fabric-bccsp.png"></p>
<blockquote>
<p>æ‰©å±•é˜…è¯»ï¼šPKCS11æ˜¯PKCSç³»åˆ—æ ‡å‡†ä¸­çš„ç¬¬11ä¸ªï¼Œå®ƒå®šä¹‰äº†åº”ç”¨å±‚å’Œåº•å±‚åŠ å¯†è®¾å¤‡çš„äº¤äº’æ ‡å‡†ï¼Œæ¯”å¦‚è¿‡å»åœ¨ç”µè„‘ä¸Šï¼Œæ’å…¥USBKeyç”¨ç½‘é“¶è½¬è´¦æ—¶ï¼Œå°±éœ€è¦èµ°USBKeyä¸­çš„ç¡¬ä»¶è¿›è¡Œæ•°å­—ç­¾åï¼Œè¿™ä¸ªè¿‡ç¨‹å°±éœ€è¦ä½¿ç”¨PCKS11ã€‚</p>
</blockquote>
<p>å¯†ç å­¦é€šå¸¸æœ‰è½¯å®ç°å’Œç¡¬å®ç°ï¼Œè½¯å®ç°å°±æ˜¯å¸¸ç”¨çš„å„ç§åŠ å¯†åº“ï¼Œæ¯”å¦‚Goä¸­<code>crypto</code>åŒ…ï¼Œç¡¬å®ç°æ˜¯ä½¿ç”¨åŠ å¯†æœºæä¾›çš„ä¸€å¥—åŠ å¯†æœåŠ¡ã€‚è½¯å®ç°å’Œç¡¬å®ç°çš„é‡è¦åŒºåˆ«æ˜¯ï¼Œå¯†ç ç®—æ³•çš„å®‰å…¨æ€§å¼ºä¾èµ–éšæœºæ•°ï¼Œè½¯å®ç°åˆ©ç”¨çš„æ˜¯OSçš„ä¼ªéšæœºæ•°ï¼Œè€Œç¡¬å®ç°åˆ©ç”¨çš„æ˜¯åŠ å¯†æœºç”Ÿæˆçš„éšæœºæ•°ï¼Œæ‰€ä»¥ç¡¬å®ç°çš„å®‰å…¨å¼ºåº¦è¦é«˜äºè½¯å®ç°ã€‚</p>
<p>è®©Fabricæ”¯æŒå›½å¯†æ—¶ï¼Œå°±éœ€è¦åœ¨bccspä¸­æ–°å¢ä¸€ä¸ªå›½å¯†æ’ä»¶<code>GM</code>ï¼Œåªåœ¨bccspä¸­å¢åŠ GMå¹¶ä¸æ˜¯å®Œæˆçš„Fabricå›½å¯†æ”¹é€ ï¼Œä¸‹æ–‡å†è¯¦ç»†ä»‹ç»ã€‚</p>
<h2 id="SWä»‹ç»"><a href="#SWä»‹ç»" class="headerlink" title="SWä»‹ç»"></a>SWä»‹ç»</h2><p>SWæ˜¯å›½é™…æ ‡å‡†åŠ å¯†çš„è½¯å®ç°æ’ä»¶ï¼Œå®ƒåŒ…å«äº†ECDSAç®—æ³•ã€RSAç®—æ³•ã€AESç®—æ³•ï¼Œä»¥åŠSHAç³»åˆ—çš„æ‘˜è¦ç®—æ³•ã€‚</p>
<p><code>BCCSP</code>æ¥å£å®šä¹‰äº†ä»¥ä¸‹æ–¹æ³•ï¼Œå…¶å®å¯¹å¯†ç å­¦ä¸­çš„å‡½æ•°è¿›è¡Œäº†ä¸€ä¸ªåŠŸèƒ½åˆ†ç±»ï¼š</p>
<ul>
<li><code>KeyGen</code>ï¼šå¯†é’¥ç”Ÿæˆï¼ŒåŒ…å«å¯¹ç§°å’Œéå¯¹ç§°åŠ å¯†</li>
<li><code>KeyDeriv</code>ï¼šå¯†é’¥æ´¾ç”Ÿ</li>
<li><code>KeyImport</code>ï¼šå¯†é’¥å¯¼å…¥ï¼Œä»æ–‡ä»¶ã€å†…å­˜ã€æ•°å­—è¯ä¹¦ä¸­å¯¼å…¥</li>
<li><code>GetKey</code>ï¼šè·å–å¯†é’¥</li>
<li><code>Hash</code>ï¼šè®¡ç®—æ‘˜è¦</li>
<li><code>GetHash</code>ï¼šè·å–æ‘˜è¦è®¡ç®—å®ä¾‹</li>
<li><code>Sign</code>ï¼šæ•°å­—ç­¾å</li>
<li><code>Verify</code>ï¼šç­¾åéªŒè¯</li>
<li><code>Encrypt</code>ï¼šæ•°æ®åŠ å¯†ï¼ŒåŒ…å«å¯¹ç§°å’Œéå¯¹ç§°åŠ å¯†</li>
<li><code>Decrypt</code>ï¼šæ•°æ®è§£å¯†ï¼ŒåŒ…å«å¯¹ç§°å’Œéå¯¹ç§°åŠ å¯†</li>
</ul>
<p>SWè¦åšçš„æ˜¯ï¼ŒæŠŠECDSAã€RSAã€AESã€SHAä¸­çš„å„ç§å‡½æ•°ï¼Œå¯¹åº”åˆ°ä»¥ä¸Šå„ç§åˆ†ç±»ä¸­ï¼Œä¸»è¦çš„åˆ†ç±»å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<p><img src="http://img.lessisbetter.site/2020-04-12-bccsp-sw.png"></p>
<p>ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œå¯†é’¥ç”Ÿæˆã€æ´¾ç”Ÿã€å¯¼å…¥éƒ½åŒ…å«äº†ECDSAã€RSAã€AESï¼Œç­¾åå’Œå»¶ç­¾åŒ…å«äº†ECDSAå’ŒRSAï¼Œæ‘˜è¦è®¡ç®—åŒ…å«äº†SHAç³»åˆ—ï¼ŒåŠ å¯†è§£å¯†åŒ…å«äº†AESï¼Œä½†æ²¡æœ‰åŒ…å«RSAï¼Œæ˜¯å› ä¸ºéå¯¹ç§°åŠ å¯†è€—æ—¶ï¼Œå¹¶ä¸å¸¸ç”¨ã€‚</p>
<h2 id="å¯æ’æ‹”å›½å¯†"><a href="#å¯æ’æ‹”å›½å¯†" class="headerlink" title="å¯æ’æ‹”å›½å¯†"></a>å¯æ’æ‹”å›½å¯†</h2><p>Fabricæ”¯æŒå›½å¯†å¹¶éä»…ä»…åœ¨bccspä¸­å¢åŠ 1ä¸ªå›½å¯†å®ç°è¿™ä¹ˆç®€å•ï¼Œè¿˜éœ€è¦è®©æ•°å­—è¯ä¹¦æ”¯æŒå›½å¯†ï¼Œè®©æ•°å­—è¯ä¹¦çš„æ“ä½œç¬¦åˆX.509ã€‚å„è¯­è¨€çš„æ ‡å‡†åº“<code>x509</code>éƒ½æ˜¯é€‚é…æ ‡å‡†åŠ å¯†çš„ï¼Œå¹¶ä¸èƒ½ç›´æ¥ç”¨æ¥æ“ä½œå›½å¯†è¯ä¹¦ã€‚</p>
<p>åœ¨æ•°å­—è¯ä¹¦æ”¯æŒå›½å¯†åï¼Œè¿˜å¯èƒ½éœ€è¦è¿›ä¸€æ­¥è€ƒè™‘ï¼Œæ˜¯å¦éœ€è¦TLSè¯ä¹¦ä½¿ç”¨å›½å¯†æ•°å­—è¯ä¹¦ï¼Œè®©é€šä¿¡è¿‡ç¨‹ä½¿ç”¨å›½å¯†ç®—æ³•ã€‚</p>
<p>å¦å¤–ï¼Œå›½å¯†çš„å®ç°æœ‰å¾ˆå¤šç‰ˆæœ¬ï¼Œå¦‚æœéœ€è¦é€‚é…ä¸åŒçš„å›½å¯†å®ç°ï¼Œå°±éœ€è¦ä¿è¯å›½å¯†çš„å¯æ’æ‹”å’Œå¯æ‰©å±•ã€‚</p>
<p>ç»¼ä¸Šæƒ…å†µï¼Œä½ éœ€è¦ä¸€ä¸ªä¸­é—´ä»¶ï¼Œä¸­é—´ä»¶ä¸­åŒ…å«å®šä¹‰å¥½å›½å¯†æ¥å£ã€å›½å¯†æ•°å­—è¯ä¹¦æ¥å£ç­‰ï¼Œç”¨è¿™äº›æ¥å£å»é€‚é…Fabricï¼Œç„¶åå½“é‡‡ç”¨ä¸åŒå›½å¯†å®ç°æ—¶ï¼Œåªéœ€è¦å¯¹å…·ä½“å®ç°è¿›è¡Œå°è£…ï¼Œå»é€‚é…ä¸­é—´ä»¶ä¸­å®šä¹‰å¥½çš„æ¥å£ã€‚</p>
<p><img src="http://img.lessisbetter.site/2020-04-fabric-gm.png"></p>
<h2 id="ç¤¾åŒºå¯¹Fabricæ”¯æŒå›½å¯†çš„æ€åº¦"><a href="#ç¤¾åŒºå¯¹Fabricæ”¯æŒå›½å¯†çš„æ€åº¦" class="headerlink" title="ç¤¾åŒºå¯¹Fabricæ”¯æŒå›½å¯†çš„æ€åº¦"></a>ç¤¾åŒºå¯¹Fabricæ”¯æŒå›½å¯†çš„æ€åº¦</h2><p>å›½å¯†æœ‰å¾ˆå¤šåŸºäºFabricçš„é¡¹ç›®ï¼Œé‡‘èä¸šæ˜¯åŒºå—é“¾åœºæ™¯æœ€å¤šçš„è¡Œä¸šï¼Œé‡‘èè¡Œä¸šåˆå¿…é¡»ä½¿ç”¨å›½å¯†ï¼Œæ‰€ä»¥å›½å†…å¯¹Fabricå›½å¯†çš„æ”¹é€ æ˜¯å¿…é¡»çš„ï¼Œåœ¨ã€Šé‡‘èåˆ†å¸ƒå¼è´¦æœ¬å®‰å…¨è§„èŒƒã€‹å‘å¸ƒä¹‹åï¼Œç¤¾åŒºä¹Ÿè®¡åˆ’è®©Fabricæ”¯æŒå›½å¯†ï¼Œä½†æ–¹å¼æ˜¯ä¸æä¾›å…·ä½“å›½å¯†å®ç°ï¼Œè€Œæ˜¯å®šä¹‰å¥½æ¥å£ï¼Œé¡¹ç›®æ–¹ä½¿ç”¨å“ªç§å›½å¯†å®ç°ï¼Œå»é€‚é…å®šä¹‰å¥½çš„æ¥å£å³å¯ï¼Œè¿™æ ·ä¿ç•™äº†å¥½çš„æ‰©å±•æ€§ï¼Œä¸<a href="#%E5%8F%AF%E6%8F%92%E6%8B%94%E5%9B%BD%E5%AF%86">å¯æ’æ‹”å›½å¯†</a>çš„ç›®çš„æ˜¯ä¸€è‡´çš„ï¼Œé€‰æ‹©æƒäº¤ç»™ä¼ä¸šã€‚</p>
<p>ç¤¾åŒºæ”¯æŒFabricå›½å¯†çš„ç‰ˆæœ¬ï¼Œé¢„è®¡åœ¨2.xç‰ˆæœ¬å‘å¸ƒã€‚</p>
<h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>å¯†ç å­¦åœ¨åŒºå—é“¾ä¸­çš„åœ°ä½æ˜¯ç›¸å½“é«˜çš„ï¼Œä»åŒºå—é“¾ä½¿ç”¨æœ€åŸºç¡€çš„å¯†ç å­¦ï¼Œåˆ°ç°åœ¨è¿˜åœ¨ä¸æ–­èå…¥åŒæ€åŠ å¯†ã€é›¶çŸ¥è¯†è¯æ˜ç­‰å‰è¨€çš„åŠ å¯†æŠ€æœ¯ï¼Œæœªæ¥å¯ä»¥åœ¨åŒºå—é“¾ä¸Šä¿æŠ¤æ•°æ®éšç§çš„æƒ…å†µï¼Œæä¾›æ›´å¥½çš„æœåŠ¡ï¼ŒåŒºå—é“¾ä¹Ÿå¯ä»¥æœ‰æ›´å¤šçš„åº”ç”¨åœºæ™¯ã€‚</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://lessisbetter.site/2020/03/23/markdown-mermaid/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://github.com/Shitaibin/shitaibin.github.io/blob/hexo_resource/images/gzh-qrcode-logo-small.png">
      <meta itemprop="name" content="å¤§å½¬">
      <meta itemprop="description" content="äº‘åŸç”Ÿã€Goè¯­è¨€ã€åŒºå—é“¾">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Goè¯­è¨€å……ç”µç«™">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/03/23/markdown-mermaid/" class="post-title-link" itemprop="url">æé«˜ç”»æ—¶åºå›¾çš„æ•ˆç‡</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2020-03-23 15:28:40" itemprop="dateCreated datePublished" datetime="2020-03-23T15:28:40+08:00">2020-03-23</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">æ›´æ–°äº</span>
        <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-12-13 14:18:43" itemprop="dateModified" datetime="2020-12-13T14:18:43+08:00">2020-12-13</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a target="_blank" rel="noopener" href="https://mermaid-js.github.io/mermaid/#/README">mermaid</a>æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œå¯ä»¥åœ¨Markdownä¸­ï¼Œä½¿ç”¨ç±»ä¼¼ç¼–å†™ä»£ç çš„æ–¹å¼ï¼Œåˆ¶ä½œæµç¨‹å›¾ã€æ—¶åºå›¾ã€ç”˜ç‰¹å›¾ã€é¥¼å›¾ç­‰ã€‚ä½¿ç”¨ä¸‹æ¥ï¼Œæ„Ÿè§‰å¯ä»¥æ˜æ˜¾æå‡æ—¶åºå›¾çš„æ•ˆç‡ã€‚</p>
<h3 id="æ—¶åºå›¾"><a href="#æ—¶åºå›¾" class="headerlink" title="æ—¶åºå›¾"></a>æ—¶åºå›¾</h3><h4 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    %% æ³¨é‡Š</span><br><span class="line">    Client -&gt;&gt; Gateway: å‘é€JSON RPCè¯·æ±‚</span><br><span class="line">    Gateway -&gt;&gt; Gateway: JSON RPCè¯·æ±‚è½¬æ¢ä¸ºgRPCè¯·æ±‚</span><br><span class="line">    Gateway -&gt;&gt; Server: å‘é€gRPCè¯·æ±‚</span><br><span class="line">    Server -&gt;&gt; Server: å¤„ç†gRPCè¯·æ±‚</span><br><span class="line">    Server -&gt;&gt; Gateway: å‘é€gRPCå“åº”</span><br><span class="line">    Gateway -&gt;&gt; Gateway: gRPCå“åº”è½¬æ¢ä¸ºJSON RPCå“åº”</span><br><span class="line">    Gateway -&gt;&gt; Client: æŠŠJSON RPCå“åº”å‘é€ç»™å®¢æˆ·ç«¯</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    %% æ³¨é‡Š</span><br><span class="line">    Client -&gt;&gt; Gateway: å‘é€JSON RPCè¯·æ±‚</span><br><span class="line">    Gateway -&gt;&gt; Gateway: JSON RPCè¯·æ±‚è½¬æ¢ä¸ºgRPCè¯·æ±‚</span><br><span class="line">    Gateway -&gt;&gt; Server: å‘é€gRPCè¯·æ±‚</span><br><span class="line">    Server -&gt;&gt; Server: å¤„ç†gRPCè¯·æ±‚</span><br><span class="line">    Server -&gt;&gt; Gateway: å‘é€gRPCå“åº”</span><br><span class="line">    Gateway -&gt;&gt; Gateway: gRPCå“åº”è½¬æ¢ä¸ºJSON RPCå“åº”</span><br><span class="line">    Gateway -&gt;&gt; Client: æŠŠJSON RPCå“åº”å‘é€ç»™å®¢æˆ·ç«¯</span><br></pre></td></tr></table></figure>

<h4 id="æ˜µç§°"><a href="#æ˜µç§°" class="headerlink" title="æ˜µç§°"></a>æ˜µç§°</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    participant C as Client</span><br><span class="line">    participant G as Gateway</span><br><span class="line">    participant S as Server</span><br><span class="line"></span><br><span class="line">    C -&gt;&gt; G: å‘é€JSON RPCè¯·æ±‚</span><br><span class="line">    G -&gt;&gt; G: JSON RPCè¯·æ±‚è½¬æ¢ä¸ºgRPCè¯·æ±‚</span><br><span class="line">    G -&gt;&gt; S: å‘é€gRPCè¯·æ±‚</span><br><span class="line">    S -&gt;&gt; S: å¤„ç†gRPCè¯·æ±‚</span><br><span class="line">    S -&gt;&gt; G: å‘é€gRPCå“åº”</span><br><span class="line">    G -&gt;&gt; G: gRPCå“åº”è½¬æ¢ä¸ºJSON RPCå“åº”</span><br><span class="line">    G -&gt;&gt; C: æŠŠJSON RPCå“åº”å‘é€ç»™å®¢æˆ·ç«¯</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    participant C as Client</span><br><span class="line">    participant G as Gateway</span><br><span class="line">    participant S as Server</span><br><span class="line">    </span><br><span class="line">    C -&gt;&gt; G: å‘é€JSON RPCè¯·æ±‚</span><br><span class="line">    G -&gt;&gt; G: JSON RPCè¯·æ±‚è½¬æ¢ä¸ºgRPCè¯·æ±‚</span><br><span class="line">    G -&gt;&gt; S: å‘é€gRPCè¯·æ±‚</span><br><span class="line">    S -&gt;&gt; S: å¤„ç†gRPCè¯·æ±‚</span><br><span class="line">    S -&gt;&gt; G: å‘é€gRPCå“åº”</span><br><span class="line">    G -&gt;&gt; G: gRPCå“åº”è½¬æ¢ä¸ºJSON RPCå“åº”</span><br><span class="line">    G -&gt;&gt; C: æŠŠJSON RPCå“åº”å‘é€ç»™å®¢æˆ·ç«¯</span><br></pre></td></tr></table></figure>

<h4 id="çº¿æ¡å’Œç®­å¤´"><a href="#çº¿æ¡å’Œç®­å¤´" class="headerlink" title="çº¿æ¡å’Œç®­å¤´"></a>çº¿æ¡å’Œç®­å¤´</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    Client -&gt; Gateway: å®çº¿</span><br><span class="line">    Client --&gt; Gateway: è™šçº¿ --</span><br><span class="line">    Client -&gt;&gt; Gateway: å¸¦ç®­å¤´ &gt;&gt;</span><br><span class="line">    Client -x Gateway: å¸¦å‰ï¼Œä¸ä½¿ç”¨&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    Client -&gt; Gateway: å®çº¿</span><br><span class="line">    Client --&gt; Gateway: è™šçº¿ --</span><br><span class="line">    Client -&gt;&gt; Gateway: å¸¦ç®­å¤´ &gt;&gt;</span><br><span class="line">    Client -x Gateway: å¸¦å‰ï¼Œä¸ä½¿ç”¨&gt;</span><br></pre></td></tr></table></figure>

<h4 id="ç¬”è®°"><a href="#ç¬”è®°" class="headerlink" title="ç¬”è®°"></a>ç¬”è®°</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    Note left of Client: åˆ›å»ºè¯·æ±‚</span><br><span class="line">    Note right of Gateway: æ¥æ”¶è¯·æ±‚</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    Note left of Client: åˆ›å»ºè¯·æ±‚</span><br><span class="line">    Note right of Gateway: æ¥æ”¶è¯·æ±‚</span><br></pre></td></tr></table></figure>

<h4 id="å¾ªç¯"><a href="#å¾ªç¯" class="headerlink" title="å¾ªç¯"></a>å¾ªç¯</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    loop Every Second</span><br><span class="line">        Client -&gt;&gt; Server: å‘é€è¯·æ±‚</span><br><span class="line">        Server -&gt;&gt; Server: å¤„ç†è¯·æ±‚</span><br><span class="line">        Server -&gt;&gt; Client: å‘é€å“åº”</span><br><span class="line">    end</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    loop Every Second</span><br><span class="line">        Client -&gt;&gt; Server: å‘é€è¯·æ±‚</span><br><span class="line">        Server -&gt;&gt; Server: å¤„ç†è¯·æ±‚</span><br><span class="line">        Server -&gt;&gt; Client: å‘é€å“åº”</span><br><span class="line">    end</span><br></pre></td></tr></table></figure>

<h4 id="Ifè¯­å¥"><a href="#Ifè¯­å¥" class="headerlink" title="Ifè¯­å¥"></a>Ifè¯­å¥</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    Client -&gt;&gt; Server: æŸ¥è¯¢ç”¨æˆ·</span><br><span class="line">    alt User not found</span><br><span class="line">        Server -&gt;&gt; Server: åˆ›å»ºé”™è¯¯å“åº”ï¼šç”¨æˆ·ä¸å­˜åœ¨</span><br><span class="line">    else </span><br><span class="line">        Server -&gt;&gt; Server: ä½¿ç”¨ç”¨æˆ·ä¿¡æ¯åˆ›å»ºå“åº”</span><br><span class="line">    end</span><br><span class="line">    Server -&gt;&gt; Client: å‘é€å“åº”</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    Client -&gt;&gt; Server: æŸ¥è¯¢ç”¨æˆ·</span><br><span class="line">    alt User not found</span><br><span class="line">        Server -&gt;&gt; Server: åˆ›å»ºé”™è¯¯å“åº”ï¼šç”¨æˆ·ä¸å­˜åœ¨</span><br><span class="line">    else </span><br><span class="line">        Server -&gt;&gt; Server: ä½¿ç”¨ç”¨æˆ·ä¿¡æ¯åˆ›å»ºå“åº”</span><br><span class="line">    end</span><br><span class="line">    Server -&gt;&gt; Client: å‘é€å“åº”</span><br></pre></td></tr></table></figure>

<h4 id="èƒŒæ™¯é¢œè‰²"><a href="#èƒŒæ™¯é¢œè‰²" class="headerlink" title="èƒŒæ™¯é¢œè‰²"></a>èƒŒæ™¯é¢œè‰²</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    Client -&gt;&gt; Server: å‘é€è¯·æ±‚</span><br><span class="line">    rect rgb(191,223,255)</span><br><span class="line">    Server -&gt;&gt; Server: å¤„ç†è¯·æ±‚</span><br><span class="line">    Server -&gt;&gt; Client: å‘é€å“åº”</span><br><span class="line">    end</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    Client -&gt;&gt; Server: å‘é€è¯·æ±‚</span><br><span class="line">    rect rgb(191,223,255)</span><br><span class="line">    Server -&gt;&gt; Server: å¤„ç†è¯·æ±‚</span><br><span class="line">    Server -&gt;&gt; Client: å‘é€å“åº”</span><br><span class="line">    end</span><br></pre></td></tr></table></figure>

<h4 id="æ¿€æ´»"><a href="#æ¿€æ´»" class="headerlink" title="æ¿€æ´»"></a>æ¿€æ´»</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    Client -&gt;&gt; Server: å‘é€è¯·æ±‚</span><br><span class="line">    activate Server</span><br><span class="line">    Server -&gt;&gt; Server: å¤„ç†è¯·æ±‚</span><br><span class="line">    Server -&gt;&gt; Client: å‘é€å“åº”</span><br><span class="line">    deactivate Server</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    Client -&gt;&gt; Server: å‘é€è¯·æ±‚</span><br><span class="line">    activate Server</span><br><span class="line">    Server -&gt;&gt; Server: å¤„ç†è¯·æ±‚</span><br><span class="line">    Server -&gt;&gt; Client: å‘é€å“åº”</span><br><span class="line">    deactivate Server</span><br></pre></td></tr></table></figure>

<h3 id="é¥¼å›¾"><a href="#é¥¼å›¾" class="headerlink" title="é¥¼å›¾"></a>é¥¼å›¾</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pie</span><br><span class="line">    title ç¡¬å¸æ­£åé¢çš„æ¦‚ç‡</span><br><span class="line">    &quot;æ­£é¢&quot;: 0.5</span><br><span class="line">    &quot;åé¢&quot;: 0.5</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pie</span><br><span class="line">    title ç¡¬å¸æ­£åé¢çš„æ¦‚ç‡</span><br><span class="line">    &quot;æ­£é¢&quot;: 0.5</span><br><span class="line">    &quot;åé¢&quot;: 0.5</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://lessisbetter.site/2020/03/22/why-pbft-needs-viewchange/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://github.com/Shitaibin/shitaibin.github.io/blob/hexo_resource/images/gzh-qrcode-logo-small.png">
      <meta itemprop="name" content="å¤§å½¬">
      <meta itemprop="description" content="äº‘åŸç”Ÿã€Goè¯­è¨€ã€åŒºå—é“¾">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Goè¯­è¨€å……ç”µç«™">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/03/22/why-pbft-needs-viewchange/" class="post-title-link" itemprop="url">ä¸ºä»€ä¹ˆPBFTéœ€è¦View Changes</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2020-03-22 14:10:53" itemprop="dateCreated datePublished" datetime="2020-03-22T14:10:53+08:00">2020-03-22</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">æ›´æ–°äº</span>
        <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-12-13 16:11:59" itemprop="dateModified" datetime="2020-12-13T16:11:59+08:00">2020-12-13</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨å½“å‰çš„PBFTèµ„æ–™ä¸­ï¼Œå°¤å…¶æ˜¯ä¸­æ–‡èµ„æ–™ï¼Œå¤šæ•°éƒ½åœ¨ä»‹ç»PBFTçš„3é˜¶æ®µæ¶ˆæ¯è¿‡ç¨‹ï¼Œå¾ˆå°‘æåŠView Changesï¼ˆè§†å›¾åˆ‡æ¢ï¼‰ï¼ŒView Changeså¯¹PBFTçš„é‡è¦æ€§ï¼Œå¦‚åŒLeader Electionå¯¹Raftçš„é‡è¦æ€§ï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸€è‡´æ€§ç®—æ³•ä¸­ï¼Œä¸å¯æˆ–ç¼ºçš„éƒ¨åˆ†ã€‚</p>
<p>ä½œè€…ä¸ºå¤§å®¶ä»‹ç»ä¸‹ï¼Œä¸ºä»€ä¹ˆView Changeså¦‚æ­¤é‡è¦ï¼Œå³ä¸ºä»€ä¹ˆPBFTéœ€è¦View Changesï¼Œä»¥åŠView Changesçš„åŸç†ã€‚</p>
<h2 id="ä¸ºä»€ä¹ˆPBFTéœ€è¦View-Changes"><a href="#ä¸ºä»€ä¹ˆPBFTéœ€è¦View-Changes" class="headerlink" title="ä¸ºä»€ä¹ˆPBFTéœ€è¦View Changes"></a>ä¸ºä»€ä¹ˆPBFTéœ€è¦View Changes</h2><p>ä¸€è‡´æ€§ç®—æ³•éƒ½è¦æä¾›ï¼š</p>
<ul>
<li>safety ï¼šåŸæ„æŒ‡ä¸ä¼šå‡ºç°é”™è¯¯æƒ…å†µï¼Œä¸€è‡´æ€§ä¸­æŒ‡æ“ä½œæ˜¯æ­£ç¡®çš„ï¼Œå¾—åˆ°ç›¸åŒçš„ç»“æœã€‚</li>
<li>liveness ï¼šæ“ä½œè¿‡ç¨‹èƒ½åœ¨æœ‰é™æ—¶é—´å†…å®Œæˆã€‚</li>
</ul>
<p><img src="http://img.lessisbetter.site/2020-03-consistency-property.png" alt="ä¸€è‡´æ€§åè®®éœ€è¦æ»¡è¶³çš„ç‰¹æ€§"></p>
<p><strong>safetyé€šå¸¸ç§°ä¸ºä¸€è‡´æ€§ï¼Œlivenessé€šå¸¸ç§°ä¸ºå¯ç”¨æ€§</strong>ï¼Œæ²¡æœ‰livenessçš„ä¸€è‡´æ€§ç®—æ³•æ— æ³•é•¿æœŸæä¾›ä¸€è‡´æ€§æœåŠ¡ï¼Œæ²¡æœ‰safetyçš„ä¸€è‡´æ€§ç®—æ³•ç§°ä¸ä¸Šä¸€è‡´æ€§ç®—æ³•ï¼Œæ‰€ä»¥ï¼Œæ‰€æœ‰çš„ä¸€è‡´æ€§ç®—æ³•éƒ½åœ¨åšäºŒè€…ä¹‹é—´çš„æŠ˜ä¸­ã€‚</p>
<p>æ‰€ä»¥å¯¹ä¸€è‡´æ€§å’Œå¯ç”¨æ€§ä¸åŒçš„è¦æ±‚ï¼Œå°±å‡ºç°äº†ä½ å¸¸å¬è§çš„ACIDåŸç†ã€CAPç†è®ºã€BASEç†è®ºã€‚</p>
<p>PBFTä½œä¸ºä¸€ä¸ªä¸€è‡´æ€§ç®—æ³•ï¼Œå®ƒä¹Ÿéœ€è¦æä¾›ä¸€è‡´æ€§å’Œå¯ç”¨æ€§ã€‚åœ¨<a href="https://lessisbetter.site/2020/03/15/why-pbft-needs-3-phase-message/">ä¸ºä»€ä¹ˆPBFTéœ€è¦3ä¸ªé˜¶æ®µæ¶ˆæ¯</a>ä¸­ï¼Œä»‹ç»äº†PBFTç®—æ³•çš„å¦‚ä½•è¾¾æˆä¸€è‡´æ€§ï¼Œå¹¶ä¸”è¯·æ±‚å¯ä»¥åœ¨æœ‰é™æ—¶é—´å†…è¾¾æˆä¸€è‡´ï¼Œå®¢æˆ·ç«¯å¾—åˆ°å“åº”ï¼Œä¹Ÿæ»¡è¶³å¯ç”¨æ€§ã€‚</p>
<p>ä½†æ²¡æœ‰ä»‹ç»ï¼Œå½“é‡åˆ°ä»¥ä¸‹æƒ…å†µæ—¶ï¼Œæ˜¯å¦è¿˜èƒ½ä¿ä½ä¸€è‡´æ€§å’Œå¯ç”¨æ€§å‘¢ï¼Ÿ</p>
<ol>
<li>ä¸»èŠ‚ç‚¹æ˜¯æ‹œå åº­èŠ‚ç‚¹ï¼ˆå®•æœºã€æ‹’ç»å“åº”â€¦ï¼‰</li>
<li>ä¸»èŠ‚ç‚¹ä¸æ˜¯æ‹œå åº­èŠ‚ç‚¹ï¼Œä½†éæ‹œå åº­å‰¯æœ¬èŠ‚ç‚¹å‚ä¸åº¦ä¸è¶³ï¼Œä¸è¶³ä»¥å®Œæˆ3é˜¶æ®µæ¶ˆæ¯</li>
<li>ç½‘ç»œä¸ç•…ï¼Œä¸¢åŒ…ä¸¥é‡ï¼Œé€ æˆä¸è¶³ä»¥å®Œæˆ3é˜¶æ®µæ¶ˆæ¯</li>
<li>â€¦</li>
</ol>
<p>åœ¨ä»¥ä¸Šåœºæ™¯ä¸­ï¼Œ<strong>æ–°çš„è¯·æ±‚æ— æ³•åœ¨æœ‰é™æ—¶é—´å†…è¾¾æˆä¸€è‡´ï¼Œè€çš„æ•°æ®å¯ä»¥ä¿æŒä¸€è‡´æ€§ï¼Œæ‰€ä»¥ä¸€è‡´æ€§æ˜¯å¯ä»¥æ»¡è¶³çš„ï¼Œä½†å¯ç”¨æ€§æ— æ³•æ»¡è¶³</strong>ã€‚å¿…é¡»å¯»æ‰¾ä¸€ä¸ªæ–¹æ¡ˆï¼Œæ¢å¤é›†ç¾¤çš„å¯ç”¨æ€§ã€‚</p>
<p><strong>PBFTç®—æ³•ä½¿ç”¨View Changesï¼Œè®©é›†ç¾¤é‡æ–°å…·æœ‰å¯ç”¨æ€§</strong>ã€‚é€šè¿‡View Changesï¼Œå¯ä»¥é€‰ä¸¾å‡ºæ–°çš„ã€è®©è¯·æ±‚åœ¨æœ‰é™æ—¶é—´å†…è¾¾æˆä¸€è‡´çš„ä¸»èŠ‚ç‚¹ï¼Œå‘å®¢æˆ·ç«¯å“åº”ï¼Œä»è€Œæ»¡è¶³å¯ç”¨æ€§çš„è¦æ±‚ã€‚</p>
<p>è®©é›†ç¾¤é‡æ–°æ¢å¤å¯ç”¨ï¼Œéœ€è¦åšåˆ°ä»€ä¹ˆå‘¢ï¼Ÿ<strong>è®©è‡³å°‘f+1ä¸ªéæ‹œå åº­èŠ‚ç‚¹è¿ç§»åˆ°ï¼Œæ–°çš„ä¸€è‡´çš„çŠ¶æ€</strong>ã€‚ç„¶åè¿™äº›èŠ‚ç‚¹ï¼Œè¿è¡Œ3é˜¶æ®µæ¶ˆæ¯åè®®ï¼Œå¤„ç†æ–°çš„å®¢æˆ·ç«¯è¯·æ±‚ï¼Œå¹¶è¾¾æˆä¸€è‡´ã€‚</p>
<h2 id="ä¸åŒç‰ˆæœ¬çš„View-Changesåè®®æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ"><a href="#ä¸åŒç‰ˆæœ¬çš„View-Changesåè®®æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ" class="headerlink" title="ä¸åŒç‰ˆæœ¬çš„View Changesåè®®æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ"></a>ä¸åŒç‰ˆæœ¬çš„View Changesåè®®æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</h2><p>PBFTç®—æ³•æœ‰1999å¹´å’Œ2001å¹´2ä¸ªç‰ˆæœ¬ï¼š</p>
<ul>
<li>99å¹´ï¼š<a target="_blank" rel="noopener" href="http://pmg.csail.mit.edu/papers/osdi99.pdf">Practical Byzantine Fault Tolerance</a>ï¼ŒPBFTåˆæ¬¡å‘è¡¨ã€‚</li>
<li>01å¹´ï¼š<a target="_blank" rel="noopener" href="http://www.pmg.csail.mit.edu/papers/bft-tocs.pdf">Practical Byzantine Fault Tolerance and Proactive Recovery</a>ï¼Œåˆç§°PBFT-PRï¼Œè®©PBFTå—æ”»å‡»æ—¶ï¼Œå…·æœ‰ä¸»åŠ¨æ¢å¤èƒ½åŠ›ã€‚</li>
</ul>
<p>PBFT-PRå¹¶éåªæ˜¯åœ¨PBFTä¸Šå¢åŠ äº†PRï¼ŒåŒæ—¶ä¹Ÿå¯¹PBFTç®—æ³•åšäº†è¯¦ç»†çš„ä»‹ç»å’Œæ”¹è¿›ï¼ŒView Changesçš„æ”¹è¿›å°±æ˜¯å…¶ä¸­ä¸€é¡¹ã€‚</p>
<p>PBFTä¸­View Changesä»‹ç»æ¯”è¾ƒç®€å•ï¼Œæ²¡æœ‰è¯´æ˜ä»¥ä¸‹åœºæ™¯ä¸‹ï¼ŒView Changesåè®®å¦‚ä½•å¤„ç†ï¼š</p>
<ul>
<li>å¦‚æœä¸‹ä¸€ä¸ªViewçš„ä¸»èŠ‚ç‚¹å®•æœºäº†æ€ä¹ˆåŠ</li>
<li>å¦‚æœä¸‹ä¸€ä¸ªViewçš„ä¸»èŠ‚ç‚¹æ˜¯æ¶æ„èŠ‚ç‚¹ï¼Œä½œæ¶æ€ä¹ˆåŠ</li>
<li>å¦‚æœéæ‹œå åº­æ¶æ„å‘èµ·View Changesï¼Œé€ æˆä¸»èŠ‚ç‚¹åˆ‡æ¢æ€ä¹ˆåŠï¼Ÿ</li>
<li>å¦‚æœå‚ä¸View Changesçš„èŠ‚ç‚¹æ•°é‡ä¸è¶³æ€ä¹ˆåŠ</li>
</ul>
<p>å¦‚æœï¼Œä»¥ä¸Šåœºæ™¯ä¸‹ï¼ŒèŠ‚ç‚¹å¤„åœ¨View Changesé˜¶æ®µï¼ŒæŒç»­çš„ç­‰å¾…ä¸‹å»ï¼Œå°±æ— æ³•æ¢å¤é›†ç¾¤çš„å¯ç”¨æ€§ã€‚</p>
<p>PBFT-PRä¸­çš„View Changesåè®®è¿›è¡Œäº†ç»†åŒ–ï¼Œå¯ä»¥è§£å†³ä»¥ä¸Šé—®é¢˜ã€‚</p>
<h2 id="2001å¹´ç‰ˆæœ¬View-Changesåè®®åŸç†"><a href="#2001å¹´ç‰ˆæœ¬View-Changesåè®®åŸç†" class="headerlink" title="2001å¹´ç‰ˆæœ¬View Changesåè®®åŸç†"></a>2001å¹´ç‰ˆæœ¬View Changesåè®®åŸç†</h2><p>æ¯ä¸ªä¸»èŠ‚ç‚¹éƒ½æ‹¥æœ‰ä¸€ä¸ªViewï¼Œå°±å¦‚åŒRaftä¸­æ¯ä¸ªleaderéƒ½æ‹¥æœ‰1ä¸ªtermã€‚ä¸åŒç‚¹æ˜¯termæ‰€å±çš„leaderæ˜¯é€‰ä¸¾å‡ºæ¥çš„ï¼Œè€ŒViewæ‰€å±çš„ä¸»èŠ‚ç‚¹æ˜¯è®¡ç®—å‡ºçš„ï¼š <code>primary = v % R</code>ï¼ŒRæ˜¯è¿è¡ŒPBFTåè®®çš„èŠ‚ç‚¹æ•°é‡ã€‚</p>
<p>View Changesçš„æˆ˜ç•¥æ˜¯ï¼šå½“å‰¯æœ¬èŠ‚ç‚¹æ€€ç–‘ä¸»èŠ‚ç‚¹æ— æ³•è®©è¯·æ±‚è¾¾æˆä¸€è‡´æ—¶ï¼Œå‘èµ·è§†å›¾åˆ‡æ¢ï¼Œæ–°çš„ä¸»èŠ‚ç‚¹æ”¶é›†å½“å‰è§†å›¾ä¸­å·²ç»Preparedï¼Œä½†æœªCommittedçš„è¯·æ±‚ï¼Œä¼ é€’åˆ°ä¸‹ä¸€ä¸ªè§†å›¾ä¸­ï¼Œæ‰€æœ‰éæ‹œå åº­èŠ‚ç‚¹åŸºäºä»¥ä¸Šè¯·æ±‚ï¼Œä¼šè¾¾åˆ°ä¸€ä¸ªæ–°çš„ã€ä¸€è‡´çš„çŠ¶æ€ã€‚ç„¶åï¼Œæ­£å¸¸è¿è¡Œ3é˜¶æ®µæ¶ˆæ¯åè®®ã€‚</p>
<p>ä¸ºä»€ä¹ˆè¦åŒ…å«å·²ç»Preparedï¼Œä½†æœªCommittedçš„è¯·æ±‚ï¼Ÿå¦‚æœä¸€ä¸ªè¯·æ±‚ï¼Œåœ¨å‰¯æœ¬èŠ‚ç‚¹iä¸Šï¼Œå·²ç»æ˜¯PreparedçŠ¶æ€ï¼Œè¯æ˜è‡³å°‘f+1çš„éæ‹œå åº­èŠ‚ç‚¹ï¼Œå·²ç»æ‹¥æœ‰æ­¤è¯·æ±‚å¹¶èµæˆè¯·æ±‚reqåœ¨è§†å›¾vä¸­ä½¿ç”¨åºå·nã€‚å¦‚æœæ²¡æœ‰é—®é¢˜ï¼Œä¸å‘ç”Ÿè§†å›¾åˆ‡æ¢ï¼Œè¿™äº›è¯·æ±‚å¯ä»¥åœ¨æœ‰é™çš„æ—¶é—´å†…è¾¾æˆä¸€è‡´ï¼Œæ–°çš„ä¸»èŠ‚ç‚¹æŠŠå·²ç»Preparedçš„è¯·æ±‚ï¼Œå¸¦åˆ°æ–°çš„viewï¼Œå¹¶è¯æ˜ç»™å…¶ä»–èŠ‚ç‚¹ï¼Œè¯·æ±‚å·²ç»Preparedï¼Œé‚£åªéœ€1è½®Commitå°±å¯ä»¥è¾¾æˆä¸€è‡´ã€‚</p>
<h3 id="View-Changesä¸»è¦æµç¨‹ç®€ä»‹"><a href="#View-Changesä¸»è¦æµç¨‹ç®€ä»‹" class="headerlink" title="View Changesä¸»è¦æµç¨‹ç®€ä»‹"></a>View Changesä¸»è¦æµç¨‹ç®€ä»‹</h3><p>å¯¹View Changesçš„æµç¨‹å¯ä»¥åˆ†ä¸º2éƒ¨åˆ†ï¼š</p>
<ul>
<li>View Changesçš„å¼€ç«¯ï¼Œå³æ¯ä¸€æ¬¡Viewçš„å¼€å§‹</li>
<li>View Changesçš„ä¸­é—´è¿‡ç¨‹ï¼Œä»¥åŠView Changesçš„ç»“æŸï¼Œåˆ‡æ¢åˆ°æ­£å¸¸æµç¨‹</li>
</ul>
<p>è¿™2éƒ¨åˆ†åˆ†åˆ«å æ®äº†ä¸‹å›¾çš„å·¦å³ä¸¤éƒ¨åˆ†ã€‚å®çº¿ä»£è¡¨æµç¨‹çº¿ï¼Œè™šçº¿ä»£è¡¨ç½‘ç»œæ¶ˆæ¯ã€‚è“è‰²ä»£è¡¨æ­£å¸¸æ“ä½œæµç¨‹ï¼ˆä¸‰é˜¶æ®µæ¶ˆæ¯ï¼šPreprepareã€Prepareã€Commitï¼‰ï¼Œé’è‰²ä»£è¡¨View Changesæµç¨‹ï¼Œè“é’ç›¸æ¥å°±æ˜¯æ­£å¸¸æµç¨‹å’ŒView Changesæµç¨‹åˆ‡æ¢çš„åœ°æ–¹ã€‚</p>
<p><img src="http://img.lessisbetter.site/2020-04-09-blueprint-view-changes.png"></p>
<p>View Changesçš„å¼€ç«¯æµç¨‹æ˜¯é€šç”¨çš„ï¼Œä¸»èŠ‚ç‚¹å’Œå‰¯æœ¬èŠ‚ç‚¹éƒ½éµå®ˆè¿™ä¸€æµç¨‹ï¼š<code>æ–°è§†å›¾ï¼šv=v+1</code>ï¼Œä»£è¡¨ä¸€ä¸ªæ–°çš„Viewå¼€å§‹ï¼ŒæŒ‡å‘å®ƒçš„æ¯ä¸€ä¸ªç®­å¤´ï¼Œéƒ½æ˜¯è§†å›¾åˆ‡æ¢çš„ä¸€ç§åŸå› ã€‚æŸä¸ªå‰¯æœ¬èŠ‚ç‚¹ï¼Œæ–°è§†å›¾çš„å¼€å§‹ï¼Œè¿˜ä¼´éšç€å¹¿æ’­<code>view-change</code>æ¶ˆæ¯ï¼Œå‘Šè¯‰å…¶ä»–èŠ‚ç‚¹ï¼Œæœ¬èŠ‚ç‚¹å¼€å¯äº†ä¸€ä¸ªæ–°çš„è§†å›¾ã€‚</p>
<p>ä¸»èŠ‚ç‚¹æ˜¯é€šè¿‡å…¬å¼ç®—å‡ºæ¥çš„ï¼Œå…¶ä½™ä¸ºå‰¯æœ¬èŠ‚ç‚¹ï¼Œåœ¨View Changesæµç¨‹ä¸­ï¼Œå‰¯æœ¬èŠ‚ç‚¹ä¼šå’Œä¸»èŠ‚ç‚¹äº¤äº’ï¼Œå…±åŒå®ŒæˆView Changesè¿‡ç¨‹ã€‚å‰¯æœ¬èŠ‚ç‚¹ä¼šå¯¹æ”¶åˆ°çš„<code>view-change</code>æ¶ˆæ¯è¿›è¡Œæ£€æŸ¥ï¼Œç„¶åæŠŠä¸€æ¡å¯¹åº”çš„<code>view-change-ack</code>æ¶ˆæ¯å‘é€ç»™ä¸»èŠ‚ç‚¹ï¼Œä¸»èŠ‚ç‚¹ä¼šä¾èµ–æ”¶åˆ°çš„<code>view-change</code>æ¶ˆæ¯å’Œ<code>view-change-ack</code>æ¶ˆæ¯æ•°é‡å’Œå†…å®¹ï¼Œäº§ç”Ÿèƒ½è®©æ‰€æœ‰èŠ‚ç‚¹ç§»åŠ¨åˆ°ç»Ÿä¸€çŠ¶æ€çš„<code>new-view</code>æ¶ˆæ¯ï¼Œå¹¶ä¸”å¯¹<code>new-view</code>æ¶ˆæ¯è¿›è¡Œ3é˜¶æ®µå…±è¯†ï¼Œå³å¯¹<code>new-view</code>æ¶ˆæ¯è¾¾æˆä¸€è‡´ï¼Œä»è€Œè®©è‡³å°‘<code>f+1</code>ä¸ªéæ‹œå åº­èŠ‚ç‚¹è¾¾æˆä¸€è‡´ã€‚</p>
<h3 id="View-Changesçš„å¼€ç«¯"><a href="#View-Changesçš„å¼€ç«¯" class="headerlink" title="View Changesçš„å¼€ç«¯"></a>View Changesçš„å¼€ç«¯</h3><p>View Changeçš„æ ¸å¿ƒå› ç´ åªæœ‰ä¸€ä¸ªï¼šæ€€ç–‘å½“å‰çš„ä¸»èŠ‚ç‚¹åœ¨æœ‰é™çš„æ—¶é—´å†…ï¼Œæ— æ³•è¾¾æˆä¸€è‡´ã€‚</p>
<p>å…·ä½“æœ‰4ä¸ªè·¯å¾„ï¼š</p>
<ol>
<li>æ­£å¸¸é˜¶æ®µå®šæ—¶å™¨è¶…æ—¶ï¼Œä»£è¡¨ä¸€å®šæ—¶é—´å†…æ— æ³•å®ŒæˆPre-prepare -&gt; Prepare -&gt; Commit</li>
<li>View Changesé˜¶æ®µå®šæ—¶å™¨è¶…æ—¶ï¼Œä»£è¡¨ä¸€å®šæ—¶é—´å†…æ— æ³•å®Œæˆæ­£åœ¨è¿›è¡Œçš„View Change</li>
<li>å®šæ—¶å™¨æœªè¶…æ—¶ï¼Œä½†æœ‰æ•ˆçš„view-changeæ¶ˆæ¯æ•°é‡è¾¾åˆ°f+1ä¸ªï¼Œä»£è¡¨å½“å‰å·²ç»æœ‰f+1ä¸ªéæ‹œå åº­èŠ‚ç‚¹å‘èµ·äº†æ–°çš„è§†å›¾åˆ‡æ¢ï¼Œæœ¬èŠ‚ç‚¹ä¸ºäº†ä¸è½åï¼Œä¸ç­‰å¾…è¶…æ—¶è€Œè¿›å…¥è§†å›¾åˆ‡æ¢</li>
<li>new-viewæ¶ˆæ¯ä¸åˆæ³•ï¼Œä»£è¡¨å½“å‰View Changesé˜¶æ®µçš„ä¸»èŠ‚ç‚¹ä¸ºæ‹œå åº­èŠ‚ç‚¹</li>
</ol>
<p>å›¾ä¸­ã€æ­£å¸¸é˜¶æ®µå®šæ—¶å™¨è¶…æ—¶ã€‘è¢«æ ‡è®°ä¸ºè“è‰²ï¼Œæ˜¯å› ä¸ºå®ƒæ˜¯æ­£å¸¸é˜¶æ®µè¿›å…¥è§†å›¾åˆ‡æ¢é˜¶æ®µçš„å¼€ç«¯ï¼Œã€æœ‰æ•ˆçš„view-changeæ¶ˆæ¯æ•°é‡è¾¾åˆ°f+1ä¸ªã€‘å³æœ‰å¯èƒ½æ˜¯æ­£å¸¸é˜¶æ®µçš„å®šæ—¶å™¨ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯è§†å›¾åˆ‡æ¢è¿‡ç¨‹ä¸­çš„å®šæ—¶å™¨ï¼Œæ‰€ä»¥é¢œè‰²æ²¡åšè°ƒæ•´ã€‚</p>
<h3 id="ä¸»å‰¯èŠ‚ç‚¹ä¸»è¦äº¤äº’æµç¨‹"><a href="#ä¸»å‰¯èŠ‚ç‚¹ä¸»è¦äº¤äº’æµç¨‹" class="headerlink" title="ä¸»å‰¯èŠ‚ç‚¹ä¸»è¦äº¤äº’æµç¨‹"></a>ä¸»å‰¯èŠ‚ç‚¹ä¸»è¦äº¤äº’æµç¨‹</h3><p>è§†å›¾åˆ‡æ¢è¿‡ç¨‹ä¸­æœ‰3ä¸ªæ¶ˆæ¯ï¼šview-changeæ¶ˆæ¯ã€view-change-ackæ¶ˆæ¯å’Œnew-viewæ¶ˆæ¯ï¼Œä¸‹æ–‡å›´ç»•è¿™3ä¸ªæ¶ˆæ¯ï¼Œå¯¹ä¸»å‰¯èŠ‚ç‚¹çš„äº¤äº’æµç¨‹åšè¯¦ç»†ä»‹ç»ã€‚</p>
<h3 id="view-changeæ¶ˆæ¯é˜¶æ®µ"><a href="#view-changeæ¶ˆæ¯é˜¶æ®µ" class="headerlink" title="view-changeæ¶ˆæ¯é˜¶æ®µ"></a>view-changeæ¶ˆæ¯é˜¶æ®µ</h3><p>åœ¨view væ—¶ï¼Œå‰¯æœ¬èŠ‚ç‚¹æ€€ç–‘ä¸»èŠ‚ç‚¹faultæ—¶ï¼Œä¼šå‘é€view-changeæ¶ˆæ¯ï¼Œè¯¥æ¶ˆæ¯åŒ…å«ï¼š</p>
<ol>
<li>hï¼šå‰¯æœ¬iæœ€æ–°çš„ç¨³å®šæ£€æŸ¥ç‚¹åºå·</li>
<li>Cï¼šå‰¯æœ¬iä¿å­˜çš„hä¹‹åçš„ï¼ˆéç¨³å®šï¼‰æ£€æŸ¥ç‚¹</li>
<li>På’ŒQ</li>
<li>iï¼šå‰¯æœ¬i</li>
<li>Î±ï¼šå‰¯æœ¬iå¯¹æœ¬æ¶ˆæ¯çš„æ•°å­—ç­¾å</li>
</ol>
<p>På’ŒQæ˜¯2ä¸ªé›†åˆã€‚</p>
<p>Pæ˜¯å·²ç»Preparedæ¶ˆæ¯çš„ä¿¡æ¯é›†åˆï¼šæ¶ˆæ¯æ—¢ç„¶å·²ç»Preparedï¼Œè¯´æ˜**è‡³å°‘2f+1çš„èŠ‚ç‚¹æ‹¥æœ‰äº†æ¶ˆæ¯ï¼Œå¹¶ä¸”è®¤å¯<code>&lt;view, n, d&gt;</code>**ï¼Œå³ä¸ºæ¶ˆæ¯åˆ†é…çš„viewå’Œåºå·ï¼Œåªæ˜¯è¿˜å·®ä¸€æ­¥commité˜¶æ®µå°±å¯ä»¥å®Œæˆä¸€è‡´æ€§ç¡®è®¤ã€‚Pä¸­åŒ…å«çš„å°±æ˜¯å·²ç»è¾¾åˆ°Preparedçš„æ¶ˆæ¯çš„æ‘˜è¦dï¼Œæ— éœ€åŒ…å«å®Œæ•´çš„è¯·æ±‚æ¶ˆæ¯ã€‚æ–°çš„viewä¸­ï¼Œè¿™äº›è¯·æ±‚ä¼šä½¿ç”¨è€çš„åºå·nï¼Œè€Œæ— éœ€åˆ†é…æ–°çš„åºå·ã€‚</p>
<p>Qæ˜¯å·²ç»Pre-preparedæ¶ˆæ¯çš„ä¿¡æ¯é›†åˆï¼Œä¸»èŠ‚ç‚¹å·²ç»å‘é€Pre-prepareæˆ–å‰¯æœ¬èŠ‚ç‚¹iä¸ºè¯·æ±‚å·²ç»å‘é€Prepareæ¶ˆæ¯ï¼Œè¯æ˜**è¯¥èŠ‚ç‚¹è®¤å¯<code>&lt;n, d, v&gt;</code>**ã€‚</p>
<p>Pã€Qä¸­çš„è¯·æ±‚éƒ½æ˜¯é«˜ä½æ°´ä½ä¹‹é—´çš„ï¼Œæ— View Changesæ—¶ï¼ŒPã€Qéƒ½æ˜¯ç©ºçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸åŒ…å«å·²ç»committedçš„è¯·æ±‚ã€‚new-viewæ¶ˆæ¯ä¸­çš„æ•°æ®ï¼ˆView Changesçš„å†³ç­–ç»“æœï¼‰ï¼Œéƒ½æ˜¯åŸºäºPã€Qé›†åˆè®¡ç®—å‡ºçš„ã€‚</p>
<p>åœ¨å‘é€view-changeæ¶ˆæ¯å‰ï¼Œå‰¯æœ¬èŠ‚ç‚¹ä¼šåˆ©ç”¨æ—¥å¿—ä¸­çš„ä¸‰é˜¶æ®µæ¶ˆæ¯è®¡ç®—Pã€Qé›†åˆï¼Œå‘é€view-changeæ¶ˆæ¯åï¼Œå°±åˆ é™¤æ—¥å¿—ä¸­çš„ä¸‰é˜¶æ®µæ¶ˆæ¯ã€‚</p>
<h3 id="view-change-ackæ¶ˆæ¯é˜¶æ®µ"><a href="#view-change-ackæ¶ˆæ¯é˜¶æ®µ" class="headerlink" title="view-change-ackæ¶ˆæ¯é˜¶æ®µ"></a>view-change-ackæ¶ˆæ¯é˜¶æ®µ</h3><p>è§†å›¾<code>v+1</code>çš„ä¸»èŠ‚ç‚¹åœ¨æ”¶åˆ°å…¶ä»–èŠ‚ç‚¹å‘é€çš„view-changeæ¶ˆæ¯åï¼Œå¹¶ä¸ç¡®è®¤view-changeæ¶ˆæ¯æ˜¯æ˜¯å¦æ‹œå åº­èŠ‚ç‚¹å‘å‡ºçš„ï¼Œå³ä¸ç¡®å®šæ¶ˆæ¯æ˜¯å¦æ˜¯æ­£ç¡®æ— è¯¯çš„ï¼Œå¦‚æœåŸºäºé”™è¯¯çš„æ¶ˆæ¯åšå†³ç­–ï¼Œå°±ä¼šå¾—åˆ°é”™è¯¯çš„ç»“æœï¼Œè¿åä¸€è‡´æ€§ï¼šä¸€åˆ‡æ“ä½œéƒ½æ˜¯æ­£ç¡®çš„ã€‚</p>
<p>è®¾ç½®view-change-ackæ¶ˆæ¯çš„ç›®çš„æ˜¯ï¼Œè®©æ‰€æœ‰å‰¯æœ¬èŠ‚ç‚¹å¯¹æ‰€æœ‰å®ƒæ”¶åˆ°çš„view-changeæ¶ˆæ¯è¿›è¡Œæ£€æŸ¥å’Œç¡®è®¤ï¼Œåªä¸è¿‡ç¡®è®¤çš„ç»“æœéƒ½å‘é€ç»™æ–°çš„ä¸»èŠ‚ç‚¹ã€‚ä¸»èŠ‚ç‚¹ç»Ÿè®¡ackæ¶ˆæ¯ï¼Œå¯ä»¥è¾¨åˆ«å“ªäº›view-changeæ˜¯æ­£ç¡®çš„ï¼Œå“ªäº›æ˜¯æ‹œå åº­èŠ‚ç‚¹å‘å‡ºçš„ã€‚</p>
<p>å‰¯æœ¬èŠ‚ç‚¹ä¼šå¯¹view-changeæ¶ˆæ¯ä¸­çš„Pã€Qé›†åˆè¿›è¡Œæ£€æŸ¥ï¼Œè¦æ±‚é›†åˆä¸­çš„è¯·æ±‚æ¶ˆæ¯å°äºç­‰äºè§†å›¾<code>v</code>ï¼Œæ»¡è¶³åˆ™å‘é€view-change-ackæ¶ˆæ¯ï¼š</p>
<ol>
<li>vï¼šv+1</li>
<li>iï¼šå‘é€ackæ¶ˆæ¯çš„å‰¯æœ¬åºå·</li>
<li>jï¼šå‰¯æœ¬iè¦ç¡®è®¤çš„view-changeæ¶ˆæ¯çš„å‘é€æ–¹</li>
<li>dï¼šå‰¯æœ¬iè¦ç¡®è®¤çš„view-changeæ¶ˆæ¯çš„æ‘˜è¦</li>
<li>Î¼ipï¼šiå‘ä¸»èŠ‚ç‚¹på‘é€æ¶ˆæ¯çš„é€šä¿¡å¯†é’¥è®¡ç®—å‡ºçš„MACï¼Œè¿™é‡Œéœ€è¦ä¿è¯iå’Œpä¹‹é—´é€šä¿¡çš„ç§å¯†æ€§ï¼Œæ‰€ä»¥ä¸ä½¿ç”¨æ•°å­—ç­¾å</li>
</ol>
<h3 id="new-viewæ¶ˆæ¯é˜¶æ®µ"><a href="#new-viewæ¶ˆæ¯é˜¶æ®µ" class="headerlink" title="new-viewæ¶ˆæ¯é˜¶æ®µ"></a>new-viewæ¶ˆæ¯é˜¶æ®µ</h3><p>æ–°è§†å›¾ä¸»èŠ‚ç‚¹pè´Ÿè´£åŸºäºview-changeæ¶ˆæ¯åšå†³ç­–ï¼Œå†³ç­–æ”¾åˆ°new-viewæ¶ˆæ¯ä¸­ã€‚</p>
<p>ä¸»èŠ‚ç‚¹pç»´æŠ¤äº†ä¸€ä¸ªé›†åˆSï¼Œç”¨æ¥å­˜æ”¾æ­£ç¡®çš„view-changeæ¶ˆæ¯ã€‚åªæœ‰view-changeæ¶ˆæ¯ï¼Œä»¥åŠä¸ºè¯¥æ¶ˆæ¯èƒŒä¹¦çš„view-change-ackæ¶ˆæ¯è¾¾åˆ°<code>2f-1</code>ä¸ªæ—¶ï¼Œview-changeæ¶ˆæ¯æ‰èƒ½åŠ å…¥åˆ°é›†åˆSï¼Œä½†view-change-ackæ¶ˆæ¯ä¸åŠ å…¥é›†åˆSã€‚</p>
<p>å½“é›†åˆSçš„å¤§å°è¾¾åˆ°<code>2f+1</code>æ—¶ï¼Œè¯æ˜æœ‰è¶³å¤Ÿå¤šçš„éæ‹œå åº­èŠ‚ç‚¹è®¤ä¸ºéœ€è¦è¿›è¡Œè§†å›¾å˜æ›´ï¼Œå¹¶æä¾›äº†å˜æ›´çš„ä¾æ®ï¼š2f+1ä¸ªview-changeæ¶ˆæ¯ï¼Œä¸»èŠ‚ç‚¹pä½¿ç”¨Såšå†³ç­–ã€‚ä»¥ä¸‹ä¾¿æ˜¯<strong>å†³ç­–é€»è¾‘</strong>ã€‚</p>
<p>ä¸»èŠ‚ç‚¹på…ˆç¡®å®šhï¼šæ‰€æœ‰view-changeæ¶ˆæ¯ä¸­æœ€å¤§çš„ç¨³å®šæ£€æŸ¥ç‚¹ã€‚hå’Œh+Lå…¶å®å°±æ˜¯é«˜ä½æ°´ä½ã€‚</p>
<p>ç„¶åä¾æ¬¡æ£€æŸ¥håˆ°h+Lä¸­çš„æ¯ä¸€ä¸ªåºå·nï¼Œå¯¹åºå·nå¯¹äºçš„è¯·æ±‚è¿›è¡Œçš„å¤„ç†ä¸ºï¼šè¯·æ±‚må·²ç»Preparedå¹¶ä¸”Pre-preparedï¼Œåˆ™æ”¶é›†åºå·nå¯¹åº”çš„è¯·æ±‚ã€‚å¦åˆ™ï¼Œè¯´æ˜æ²¡æœ‰è¯·æ±‚åœ¨åºå·nèƒ½è¾¾åˆ°committedï¼Œä¸ºåºå·nåˆ†é…ä¸€ä¸ªç©ºè¯·æ±‚ï¼Œå¹¶æ”¶é›†èµ·æ¥ã€‚å®ƒä»¬æœ€åä¼šè¢«æ”¾åˆ°new-viewæ¶ˆæ¯çš„Xé›†åˆä¸­ã€‚</p>
<p>ä¸»èŠ‚ç‚¹ä¼šåˆ›å»ºnew-viewæ¶ˆæ¯ï¼š</p>
<ul>
<li>viewï¼šå½“å‰æ–°è§†å›¾çš„ç¼–å·</li>
<li>Vï¼šæ˜¯ä¸€ä¸ªé›†åˆï¼Œæ¯ä¸ªå…ƒç´ æ˜¯ä¸€å¯¹<code>(i, d)</code>ï¼Œä»£è¡¨iå‘é€çš„view-changeæ¶ˆæ¯æ‘˜è¦æ˜¯dï¼Œæ¯ä¸€å¯¹éƒ½ä¸é›†åˆSä¸­æ¶ˆæ¯å¯¹åº”ï¼Œå¯ä»¥ä½¿ç”¨Vè¯æ˜ä¸»èŠ‚ç‚¹æ˜¯åœ¨æ»¡è¶³æ¡ä»¶ä¸‹ï¼Œåˆ›å»ºnew-viewæ¶ˆæ¯çš„ï¼Œå³Væ˜¯æ–°è§†å›¾çš„è¯æ˜ã€‚å› ä¸ºå…¶å®ƒå¤šæ•°å‰¯æœ¬èŠ‚ç‚¹å·²ç»æ¥æ”¶view-changeæ¶ˆæ¯ï¼Œæ‰€ä»¥æ­¤å¤„å‘é€æ¶ˆæ¯çš„æ‘˜è¦åšå¯¹æ¯”å³å¯ã€‚</li>
<li>Xï¼šæ˜¯ä¸€ä¸ªé›†åˆï¼ŒåŒ…å«æ£€æŸ¥ç‚¹ä»¥åŠé€‰å®šçš„è¯·æ±‚</li>
<li>Î±ï¼šä¸»èŠ‚ç‚¹på¯¹new-viewæ¶ˆæ¯çš„æ•°å­—ç­¾å</li>
</ul>
<p>ä¹‹åï¼Œä¸»èŠ‚ç‚¹ä¼šæŠŠnew-viewæ¶ˆæ¯å¹¿æ’­ç»™æ¯ä¸€ä¸ªå‰¯æœ¬èŠ‚ç‚¹ã€‚</p>
<h3 id="å¤„ç†new-viewæ¶ˆæ¯"><a href="#å¤„ç†new-viewæ¶ˆæ¯" class="headerlink" title="å¤„ç†new-viewæ¶ˆæ¯"></a>å¤„ç†new-viewæ¶ˆæ¯</h3><h4 id="ä¸»èŠ‚ç‚¹å¤„ç†new-viewæ¶ˆæ¯"><a href="#ä¸»èŠ‚ç‚¹å¤„ç†new-viewæ¶ˆæ¯" class="headerlink" title="ä¸»èŠ‚ç‚¹å¤„ç†new-viewæ¶ˆæ¯"></a>ä¸»èŠ‚ç‚¹å¤„ç†new-viewæ¶ˆæ¯</h4><p>åœ¨å‘ç”ŸView Changesæ—¶ï¼Œä¸»èŠ‚ç‚¹çš„çŠ¶æ€å¯èƒ½ä¹Ÿä¸æ˜¯æœ€å…¨çš„ï¼Œå¦‚æœå®ƒæ²¡æœ‰Xç»“åˆä¸­çš„è¯·æ±‚æˆ–è€…æ£€æŸ¥ç‚¹ï¼Œå®ƒå¯ä»¥ä»å…¶ä»–èŠ‚ç‚¹å“ªæ‹‰å»ã€‚</p>
<p>ä¸»èŠ‚ç‚¹éœ€è¦ä½¿ç”¨new-viewæ¶ˆæ¯ï¼Œè¾¾åˆ°è§†å›¾åˆ‡æ¢çš„æœ€åä¸€æ­¥çŠ¶æ€ï¼šåœ¨æ–°è§†å›¾v+1ä¸­ï¼Œè®©é›†åˆXä¸­çš„è¯·æ±‚ï¼Œå…¨éƒ¨æ˜¯Pre-preparedçŠ¶æ€ã€‚ä¸ºä½•æ˜¯Pre-preparedçŠ¶æ€å‘¢ï¼Ÿå› ä¸ºnew-viewæ¶ˆæ¯ï¼Œå¯ä»¥çœ‹åšä¸€æ¬¡ç‰¹æ®Šçš„Pre-prepareæ¶ˆæ¯ã€‚</p>
<p>ä¸ºä»€ä¹ˆä¸ç›´æ¥æ ‡è®°ä¸ºCommittedå‘¢ï¼Ÿå› ä¸ºä¸»èŠ‚ç‚¹ä¹Ÿå¯èƒ½æ˜¯æ‹œå åº­èŠ‚ç‚¹ï¼Œå‰¯æœ¬èŠ‚ç‚¹éœ€è¦æ£€æŸ¥new-viewæ¶ˆæ¯ï¼Œå‘æ‰€æœ‰èŠ‚ç‚¹å¹¿æ’­è‡ªå·±æ£€æŸ¥çš„ç»“æœï¼Œæ»¡è¶³æ¡ä»¶åæ‰èƒ½è¾¾æˆä¸€è‡´æ€§ã€‚</p>
<h4 id="å‰¯æœ¬èŠ‚ç‚¹å¤„ç†new-viewæ¶ˆæ¯"><a href="#å‰¯æœ¬èŠ‚ç‚¹å¤„ç†new-viewæ¶ˆæ¯" class="headerlink" title="å‰¯æœ¬èŠ‚ç‚¹å¤„ç†new-viewæ¶ˆæ¯"></a>å‰¯æœ¬èŠ‚ç‚¹å¤„ç†new-viewæ¶ˆæ¯</h4><p>å‰¯æœ¬èŠ‚ç‚¹åœ¨è§†å›¾v+1ï¼Œä¼šæŒç»­æ¥æ”¶view-changeæ¶ˆæ¯å’Œnew-viewæ¶ˆæ¯ï¼Œå®ƒä¼šæŠŠnew-viewæ¶ˆæ¯Vé›†åˆä¸­çš„view-changeæ¶ˆæ¯ï¼Œè·Ÿå®ƒæ”¶åˆ°çš„æ¶ˆæ¯åšå¯¹æ¯”ï¼Œå¦‚æœå®ƒæœ¬åœ°ä¸å­˜åœ¨æŸæ¡view-changeæ¶ˆæ¯ï¼Œå®ƒå¯ä»¥è¦æ±‚ä¸»èŠ‚ç‚¹å‘ä»–æä¾›view-changeæ¶ˆæ¯å’Œview-change-ackæ¶ˆæ¯é›†åˆï¼Œè¯æ˜è‡³å°‘f+1ä¸ªéæ‹œå åº­å‰¯æœ¬èŠ‚ç‚¹æ”¶åˆ°è¿‡æ­¤view-changeæ¶ˆæ¯ã€‚</p>
<p>å‰¯æœ¬èŠ‚ç‚¹æ‹¥æœ‰æ‰€æœ‰çš„view-changeæ¶ˆæ¯ä¹‹åï¼Œå‰¯æœ¬èŠ‚ç‚¹ä¼šå’Œä¸»èŠ‚ç‚¹è¿è¡Œç›¸åŒçš„å†³ç­–é€»è¾‘ï¼Œä»¥æ ¡éªŒnew-viewæ¶ˆæ¯çš„æ­£ç¡®æ€§ã€‚</p>
<p>å¦‚æœnew-viewæ¶ˆæ¯æ˜¯æ­£ç¡®çš„ï¼Œå‰¯æœ¬èŠ‚ç‚¹ä¼šå’Œä¸»èŠ‚ç‚¹ä¸€æ ·ç§»åŠ¨åˆ°ç›¸åŒçš„çŠ¶æ€ï¼Œç„¶åå¹¿æ’­ä¸€æ¡Prepareæ¶ˆæ¯ç»™æ‰€æœ‰èŠ‚ç‚¹ï¼Œè¿™æ ·å°±æ¢å¤åˆ°äº†æ­£å¸¸æƒ…å†µä¸‹çš„ï¼š<code>Pre-prepare -&gt; Prepare -&gt; Commit</code> ä¸€è‡´æ€§é€»è¾‘ã€‚è¿™æ ·å°±å®Œæˆäº†ä»View Changesåˆ°æ­£å¸¸å¤„ç†æµç¨‹çš„è¿ç§»ã€‚</p>
<p>å¦‚æœnew-viewæ¶ˆæ¯æ˜¯é”™è¯¯çš„ï¼Œè¯´æ˜ä¸»èŠ‚ç‚¹pæ˜¯æ‹œå åº­èŠ‚ç‚¹ï¼Œå‰¯æœ¬èŠ‚ç‚¹ä¼šç›´æ¥è¿›å…¥v+2ï¼Œå‘é€view-changeæ¶ˆæ¯ï¼Œè¿›è¡Œæ–°çš„ä¸€è½®è§†å›¾åˆ‡æ¢ã€‚</p>
<h3 id="View-Changeså¦‚ä½•æä¾›liveness"><a href="#View-Changeså¦‚ä½•æä¾›liveness" class="headerlink" title="View Changeså¦‚ä½•æä¾›liveness"></a>View Changeså¦‚ä½•æä¾›liveness</h3><p>åœ¨ä¸€è½®è§†å›¾åˆ‡æ¢æ— æ³•å®Œæˆçš„æ—¶å€™ï¼Œä¼šå¼€å¯æ–°çš„ä¸€è½®è§†å›¾åˆ‡æ¢ï¼Œç”±äºæ‹œå åº­èŠ‚ç‚¹çš„æ•°é‡æœ€å¤šä¸ºfä¸ªï¼Œæœ€ç»ˆä¼šåœ¨æŸä¸€è½®è§†å›¾åˆ‡æ¢ä¸­ï¼Œèƒ½å¤Ÿå®Œæˆè§†å›¾åˆ‡æ¢ï¼Œæ‰€æœ‰éæ‹œå åº­èŠ‚ç‚¹è¾¾æˆä¸€è‡´çš„çŠ¶æ€ï¼Œä¿è¯livenesså’Œsafetyã€‚</p>
<p>æœ¬æ–‡å‰é¢åˆ—å‡ºäº†å‡ ç§å¼‚å¸¸æƒ…å†µï¼Œä¸‹é¢å°±çœ‹ä¸€ä¸‹View Changesæ˜¯å¦‚ä½•åº”å¯¹è¿™äº›å¼‚å¸¸æƒ…å†µçš„ï¼Œä»¥åŠå¦‚ä½•æä¾›æ´»æ€§ã€‚</p>
<p>Q1ï¼šå¦‚æœä¸‹ä¸€ä¸ªViewçš„ä¸»èŠ‚ç‚¹å®•æœºäº†æ€ä¹ˆåŠï¼Ÿ</p>
<p>A1ï¼šå‰¯æœ¬èŠ‚ç‚¹åœ¨æ”¶é›†åˆ°2f+1ä¸ªview-changeæ¶ˆæ¯åï¼Œä¼šå¯åŠ¨å®šæ—¶å™¨ï¼Œè¶…æ—¶æ—¶é—´ä¸ºTï¼Œæ–°viewçš„ä¸»èŠ‚ç‚¹å®•æœºï¼Œå¿…ç„¶ä¼šå¯¼è‡´å®šæ—¶å™¨è¶…æ—¶æ—¶ï¼Œæœªèƒ½å®ŒæˆView Changesæµç¨‹ï¼Œä¼šè¿›å…¥æ–°ä¸€è½®è§†å›¾åˆ‡æ¢ã€‚</p>
<p>Q2ï¼šå¦‚æœä¸‹ä¸€ä¸ªViewçš„ä¸»èŠ‚ç‚¹æ˜¯æ¶æ„èŠ‚ç‚¹ï¼Œä½œæ¶æ€ä¹ˆåŠï¼Ÿ</p>
<p>A2ï¼šæ–°viewçš„ä¸»èŠ‚ç‚¹æ˜¯æ¶æ„èŠ‚ç‚¹ï¼Œå¦‚æœå®ƒåšæ¶äº†ï¼Œç”Ÿæˆçš„new-viewæ¶ˆæ¯ä¸åˆæ³•ï¼Œå‰¯æœ¬èŠ‚ç‚¹å¯ä»¥æ£€æµ‹å‡ºæ¥ã€‚æˆ–è€…new-viewæ¶ˆæ¯æ˜¯åˆæ³•çš„ï¼Œä½†å®ƒåªå‘é€ç»™äº†å°‘æ•°å‰¯æœ¬èŠ‚ç‚¹ï¼Œå‰¯æœ¬èŠ‚ç‚¹åœ¨å¯¹new-viewæ¶ˆæ¯è¿›è¡Œæ­£å¸¸çš„3é˜¶æ®µæµç¨‹ï¼Œå‚ä¸çš„èŠ‚ç‚¹å¤ªå°‘ï¼Œåœ¨å®šæ—¶å™¨è¶…æ—¶å‰ï¼Œä¸è¶³ä»¥å®Œæˆ3é˜¶æ®µæµç¨‹ï¼Œå‰¯æœ¬èŠ‚ç‚¹ä¼šè¿›å…¥ä¸‹ä¸€è½®è§†å›¾åˆ‡æ¢ã€‚</p>
<p>Q3ï¼šå¦‚æœéæ‹œå åº­æ¶æ„å‘èµ·View Changesï¼Œé€ æˆä¸»èŠ‚ç‚¹åˆ‡æ¢æ€ä¹ˆåŠï¼Ÿ</p>
<p>A3ï¼šå®šæ—¶å™¨æœªè¶…æ—¶æƒ…å†µä¸‹ï¼Œåªæœ‰æœ‰æ•ˆçš„f+1ä¸ªview-changeæ¶ˆæ¯ï¼Œæ‰ä¼šå¼•å‘å…¶ä»–å‰¯æœ¬èŠ‚ç‚¹è¿›è¡Œä¸»èŠ‚ç‚¹åˆ‡æ¢ï¼Œå¦åˆ™æ— æ³•é€ æˆä¸»èŠ‚ç‚¹åˆ‡æ¢ã€‚ä½†PBFTçš„å‰ææ¡ä»¶æ˜¯æ¶æ„èŠ‚ç‚¹ä¸è¶³fä¸ªï¼Œæ‰€ä»¥åªæœ‰æ¶æ„èŠ‚ç‚¹å‘èµ·view-changeæ¶ˆæ¯æ—¶ï¼Œæ— æ³•é€ æˆä¸»èŠ‚ç‚¹åˆ‡æ¢ã€‚</p>
<p>Q4ï¼šå¦‚æœå‚ä¸View Changesçš„èŠ‚ç‚¹æ•°é‡ä¸è¶³æ€ä¹ˆåŠï¼Ÿ</p>
<p>A4ï¼šè¿™ä¸ªé—®é¢˜å¯ä»¥åˆ†å‡ ç§æƒ…å†µã€‚</p>
<ul>
<li>å‘èµ·view-changeçš„èŠ‚ç‚¹æ•°é‡ä¸è¶³f+1ä¸ªï¼Œè¿™ç§æƒ…å†µä¸ä¼šå‘ç”Ÿæ•´ä¸ªé›†ç¾¤çš„è§†å›¾åˆ‡æ¢ã€‚</li>
<li>è§†å›¾åˆ‡æ¢è¿‡ç¨‹ä¸­ï¼Œä¸æ»¡è¶³å„èŠ‚ç‚¹çš„æ•°é‡è¦æ±‚ï¼Œæ— æ³•å®Œæˆæœ¬è½®è§†å›¾åˆ‡æ¢ï¼Œä¼šè¿›å…¥ä¸‹ä¸€è½®è§†å›¾åˆ‡æ¢ã€‚</li>
</ul>
<h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>View Changesæ˜¯PBFTä¸­ä¸€ä¸ªé‡è¦çš„ç¯èŠ‚ï¼Œå®ƒèƒ½ä¿è¯æ•´ä¸ªåè®®çš„livenessï¼Œæ˜¯PBFTä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ã€‚</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://lessisbetter.site/2020/03/15/gops-introduction/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://github.com/Shitaibin/shitaibin.github.io/blob/hexo_resource/images/gzh-qrcode-logo-small.png">
      <meta itemprop="name" content="å¤§å½¬">
      <meta itemprop="description" content="äº‘åŸç”Ÿã€Goè¯­è¨€ã€åŒºå—é“¾">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Goè¯­è¨€å……ç”µç«™">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/03/15/gops-introduction/" class="post-title-link" itemprop="url">Goå®˜æ–¹è¿›ç¨‹è¯Šæ–­å·¥å…·gopsè¯¦è§£</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2020-03-15 20:20:47" itemprop="dateCreated datePublished" datetime="2020-03-15T20:20:47+08:00">2020-03-15</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">æ›´æ–°äº</span>
        <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-12-13 16:11:59" itemprop="dateModified" datetime="2020-12-13T16:11:59+08:00">2020-12-13</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="gopsç®€ä»‹"><a href="#gopsç®€ä»‹" class="headerlink" title="gopsç®€ä»‹"></a>gopsç®€ä»‹</h2><p><a target="_blank" rel="noopener" href="https://github.com/google/gops">gops</a> æ˜¯Goå›¢é˜Ÿæä¾›çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå®ƒå¯ä»¥ç”¨æ¥è·å–goè¿›ç¨‹è¿è¡Œæ—¶ä¿¡æ¯ã€‚</p>
<p>å¯ä»¥æŸ¥çœ‹ï¼š</p>
<ul>
<li>å½“å‰æœ‰å“ªäº›goè¯­è¨€è¿›ç¨‹ï¼Œå“ªäº›ä½¿ç”¨gopsçš„goè¿›ç¨‹</li>
<li>è¿›ç¨‹çš„æ¦‚è¦ä¿¡æ¯</li>
<li>è¿›ç¨‹çš„è°ƒç”¨æ ˆ</li>
<li>è¿›ç¨‹çš„å†…å­˜ä½¿ç”¨æƒ…å†µ</li>
<li>æ„å»ºç¨‹åºçš„Goç‰ˆæœ¬</li>
<li>è¿è¡Œæ—¶ç»Ÿè®¡ä¿¡æ¯</li>
</ul>
<p>å¯ä»¥è·å–ï¼š</p>
<ul>
<li>trace</li>
<li>cpu profileå’Œmemory profile</li>
</ul>
<p>è¿˜å¯ä»¥ï¼š</p>
<ul>
<li>è®©è¿›ç¨‹è¿›è¡Œ1æ¬¡GC</li>
<li>è®¾ç½®GCç™¾åˆ†æ¯”</li>
</ul>
<h2 id="ç¤ºä¾‹ä»£ç "><a href="#ç¤ºä¾‹ä»£ç " class="headerlink" title="ç¤ºä¾‹ä»£ç "></a>ç¤ºä¾‹ä»£ç </h2><p>ä½¿ç”¨<code>Options</code>é…ç½®agentã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line">	<span class="string">&quot;runtime&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="string">&quot;github.com/google/gops/agent&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> err := agent.Listen(agent.Options&#123;</span><br><span class="line">		Addr:            <span class="string">&quot;0.0.0.0:8848&quot;</span>,</span><br><span class="line">		<span class="comment">// ConfigDir:       &quot;/home/centos/gopsconfig&quot;, // æœ€å¥½ä½¿ç”¨é»˜è®¤</span></span><br><span class="line">		ShutdownCleanup: <span class="literal">true</span>&#125;); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Fatal(err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æµ‹è¯•ä»£ç </span></span><br><span class="line">	_ = <span class="built_in">make</span>([]<span class="keyword">int</span>, <span class="number">1000</span>, <span class="number">1000</span>)</span><br><span class="line">	runtime.GC()</span><br><span class="line"></span><br><span class="line">	_ = <span class="built_in">make</span>([]<span class="keyword">int</span>, <span class="number">1000</span>, <span class="number">2000</span>)</span><br><span class="line">	runtime.GC()</span><br><span class="line"></span><br><span class="line">	time.Sleep(time.Hour)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="agent-Optioné€‰é¡¹"><a href="#agent-Optioné€‰é¡¹" class="headerlink" title="agent Optioné€‰é¡¹"></a>agent Optioné€‰é¡¹</h2><p>agentæœ‰3ä¸ªé…ç½®ï¼š</p>
<ul>
<li><code>Addr</code>ï¼šagentè¦ç›‘å¬çš„ipå’Œç«¯å£ï¼Œé»˜è®¤ipä¸ºç¯å›åœ°å€ï¼Œç«¯å£éšæœºåˆ†é…ã€‚</li>
<li><code>ConfigDir</code>ï¼šè¯¥ç›®å½•å­˜æ”¾çš„ä¸æ˜¯agentçš„é…ç½®ï¼Œè€Œæ˜¯æ¯ä¸€ä¸ªä½¿ç”¨äº†agentçš„goè¿›ç¨‹ä¿¡æ¯ï¼Œæ–‡ä»¶ä»¥pidå‘½åï¼Œå†…å®¹æ˜¯è¯¥pidè¿›ç¨‹æ‰€ç›‘å¬çš„ç«¯å£å·ï¼Œæ‰€ä»¥å…¶ä¸­æ–‡ä»¶çš„ç›®çš„æ˜¯å½¢æˆpidåˆ°ç«¯å£çš„æ˜ å°„ã€‚é»˜è®¤å€¼ä¸º<code>~/.config/gops</code></li>
<li><code>ShutdownCleanup</code>ï¼šè¿›ç¨‹é€€å‡ºæ—¶ï¼Œæ˜¯å¦æ¸…ç†ConfigDirä¸­çš„æ–‡ä»¶ï¼Œé»˜è®¤å€¼ä¸ºfalseï¼Œä¸æ¸…ç†</li>
</ul>
<p>é€šå¸¸å¯ä»¥æŠŠ<code>Addr</code>è®¾ç½®ä¸ºè¦ç›‘å¬çš„IPï¼ŒæŠŠ<code>ShutdownCleanup</code>è®¾ç½®ä¸º<code>ture</code>ï¼Œè¿›ç¨‹é€€å‡ºåï¼Œæ®‹ç•™åœ¨ConfigDirç›®å½•çš„æ–‡ä»¶ä¸å†æœ‰ç”¨ï¼Œæœ€å¥½æ¸…é™¤æ‰ã€‚</p>
<p><code>ConfigDir</code>ç¤ºä¾‹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// gopsconfigä¸ºè®¾ç½®çš„ConfigDirç›®å½•ï¼Œ2051ä¸ºpidï¼Œ8848ä¸ºç«¯å£å·ã€‚</span><br><span class="line">âœ  ~ cat gopsconfig/2051</span><br><span class="line">8848%</span><br><span class="line">âœ  ~ netstat -nap | grep `pgrep gopsexample`</span><br><span class="line">tcp6       0      0 :::8848                 :::*                    LISTEN      2051/./gopsexample</span><br></pre></td></tr></table></figure>

<h2 id="gopsåŸç†"><a href="#gopsåŸç†" class="headerlink" title="gopsåŸç†"></a>gopsåŸç†</h2><p>gopsçš„åŸç†æ˜¯ï¼Œä»£ç ä¸­å¯¼å…¥<code>gops/agent</code>ï¼Œå»ºç«‹agentæœåŠ¡ï¼Œgopså‘½ä»¤è¿æ¥<code>agent</code>è¯»å–è¿›ç¨‹ä¿¡æ¯ã€‚</p>
<p><img src="http://img.lessisbetter.site/2020-03-gops.png" alt="gops"></p>
<p><code>agent</code>çš„å®ç°åŸç†å¯ä»¥æŸ¥çœ‹<code>agent/handle</code><a target="_blank" rel="noopener" href="https://github.com/google/gops/blob/master/agent/agent.go#L182">å‡½æ•°</a>ã€‚</p>
<p>ä½¿ç”¨goæ ‡å‡†åº“ä¸­åŸç”Ÿæ¥å£å®ç°ç›¸å…³åŠŸèƒ½ï¼Œå¦‚åŒä½ è¦åœ¨è‡ªå·±çš„ç¨‹åºä¸­å¼€å¯pprofç±»ä¼¼ï¼Œåªä¸è¿‡è¿™éƒ¨åˆ†åŠŸèƒ½ç”±<code>gops/agent</code>å®ç°äº†ï¼š</p>
<ul>
<li>ä½¿ç”¨<code>runtime.MemStats</code>è·å–å†…å­˜æƒ…å†µ</li>
<li>ä½¿ç”¨<code>runtime/pprof</code>è·å–è°ƒç”¨æ ˆã€cpu profileå’Œmemory profile</li>
<li>ä½¿ç”¨<code>runtime/trace</code>è·å–trace</li>
<li>ä½¿ç”¨<code>runtime</code>è·å–statsä¿¡æ¯</li>
<li>ä½¿ç”¨<code>runtime/debug</code>ã€<code>GC</code>è®¾ç½®å’Œå¯åŠ¨GC</li>
</ul>
<p>å†è°ˆ<code>ConfigDir</code>ã€‚ä»æºç ä¸Šçœ‹ï¼Œ<code>ConfigDir</code>å¯¹agentå¹¶æ²¡æœ‰ç”¨é€”ï¼Œå¯¹gopsæœ‰ç”¨ã€‚å½“gopså’ŒConfigDiråœ¨ä¸€å°æœºå™¨ä¸Šæ—¶ï¼Œå³gopsæŸ¥çœ‹æœ¬æœºçš„goè¿›ç¨‹ä¿¡æ¯ï¼Œgopså¯ä»¥é€šè¿‡å…¶ä¸­çš„æ–‡ä»¶ï¼Œå¿«é€Ÿæ‰¾åˆ°agentæœåŠ¡çš„ç«¯å£ã€‚èƒ½å¤Ÿå®ç°ï¼š<code>gops &lt;sub-cmd&gt; pid</code>åˆ°<code>gops &lt;sub-cmd&gt; 127.0.0.1:port</code>çš„è½¬æ¢ã€‚</p>
<p>å¦‚æœä»£ç ä¸­é€šè¿‡<code>ConfigDir</code>æŒ‡å®šäº†å…¶ä»–ç›®å½•ï¼Œä½¿ç”¨<code>gops</code>æ—¶ï¼Œéœ€è¦æ·»åŠ ç¯å¢ƒå˜é‡<code>GOPS_CONFIG_DIR</code>æŒ‡å‘<code>ConfigDir</code>ä½¿ç”¨çš„ç›®å½•ã€‚</p>
<h2 id="å­å‘½ä»¤ä»‹ç»"><a href="#å­å‘½ä»¤ä»‹ç»" class="headerlink" title="å­å‘½ä»¤ä»‹ç»"></a>å­å‘½ä»¤ä»‹ç»</h2><p>gopsåé¢å¯ä»¥è·Ÿå­å‘½ä»¤ï¼Œç„¶åæ˜¯pidæˆ–è€…è¿œç«¯åœ°å€ã€‚</p>
<p>ä¹Ÿå¯ä»¥ç›´æ¥è·Ÿpidï¼ŒæŸ¥çœ‹æœ¬æœºè¿›ç¨‹ä¿¡æ¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ gops help memstats</span><br><span class="line">gops is a tool to list and diagnose Go processes.</span><br><span class="line"></span><br><span class="line">Usage:</span><br><span class="line">  gops &lt;cmd&gt; &lt;pid|addr&gt; ...</span><br><span class="line">  gops &lt;pid&gt; # displays process info</span><br><span class="line">  gops help  # displays this help message</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">  stack      Prints the stack trace.</span><br><span class="line">  gc         Runs the garbage collector and blocks until successful.</span><br><span class="line">  setgc	     Sets the garbage collection target percentage.</span><br><span class="line">  memstats   Prints the allocation and garbage collection stats.</span><br><span class="line">  version    Prints the Go version used to build the program.</span><br><span class="line">  stats      Prints runtime stats.</span><br><span class="line">  trace      Runs the runtime tracer for 5 secs and launches &quot;go tool trace&quot;.</span><br><span class="line">  pprof-heap Reads the heap profile and launches &quot;go tool pprof&quot;.</span><br><span class="line">  pprof-cpu  Reads the CPU profile and launches &quot;go tool pprof&quot;.</span><br><span class="line"></span><br><span class="line">All commands require the agent running on the Go process.</span><br><span class="line">&quot;*&quot; indicates the process is running the agent.</span><br></pre></td></tr></table></figure>

<h3 id="æŸ¥çœ‹å½“å‰æœºå™¨ä¸Šgoç¨‹åºè¿›ç¨‹ä¿¡æ¯"><a href="#æŸ¥çœ‹å½“å‰æœºå™¨ä¸Šgoç¨‹åºè¿›ç¨‹ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹å½“å‰æœºå™¨ä¸Šgoç¨‹åºè¿›ç¨‹ä¿¡æ¯"></a>æŸ¥çœ‹å½“å‰æœºå™¨ä¸Šgoç¨‹åºè¿›ç¨‹ä¿¡æ¯</h3><p>æŸ¥çœ‹å½“å‰æœºå™¨ä¸Šçš„goè¿›ç¨‹ï¼Œå¯ä»¥åˆ—å‡ºpidã€ppidã€è¿›ç¨‹åã€å¯æ‰§è¡Œç¨‹åºæ‰€ä½¿ç”¨çš„goç‰ˆæœ¬ï¼Œä»¥åŠå¯æ‰§è¡Œç¨‹åºçš„è·¯å¾„ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ gops</span><br><span class="line">67292 66333 gops                         * go1.13    &#x2F;Users&#x2F;shitaibin&#x2F;Workspace&#x2F;golang_step_by_step&#x2F;gops&#x2F;gops</span><br><span class="line">67434 65931 gops                           go1.13    &#x2F;Users&#x2F;shitaibin&#x2F;go&#x2F;bin&#x2F;gops</span><br><span class="line">66551 1     gocode                         go1.11.2  &#x2F;Users&#x2F;shitaibin&#x2F;go&#x2F;bin&#x2F;gocode</span><br><span class="line">137   1     com.docker.vmnetd              go1.12.7  &#x2F;Library&#x2F;PrivilegedHelperTools&#x2F;com.docker.vmnetd</span><br><span class="line">811   807   com.docker.backend             go1.12.13 &#x2F;Applications&#x2F;Docker.app&#x2F;Contents&#x2F;MacOS&#x2F;com.docker.backend</span><br><span class="line">807   746   com.docker.supervisor          go1.12.13 &#x2F;Applications&#x2F;Docker.app&#x2F;Contents&#x2F;MacOS&#x2F;com.docker.supervisor</span><br><span class="line">810   807   com.docker.driver.amd64-linux  go1.12.13 &#x2F;Applications&#x2F;Docker.app&#x2F;Contents&#x2F;MacOS&#x2F;com.docker.driver.amd64-linux</span><br></pre></td></tr></table></figure>

<p>å¸¦<code>*</code>çš„æ˜¯ç¨‹åºä¸­ä½¿ç”¨äº†gops/agentï¼Œä¸å¸¦<code>*</code>çš„æ˜¯æ™®é€šçš„goç¨‹åºã€‚</p>
<h3 id="goç¨‹åºè¿›ç¨‹æ ‘"><a href="#goç¨‹åºè¿›ç¨‹æ ‘" class="headerlink" title="goç¨‹åºè¿›ç¨‹æ ‘"></a>goç¨‹åºè¿›ç¨‹æ ‘</h3><p>æŸ¥çœ‹è¿›ç¨‹æ ‘ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ gops tree</span><br><span class="line">...</span><br><span class="line">â”œâ”€â”€ 66333</span><br><span class="line">â”‚Â Â  â””â”€â”€ [*]  67292 (gops) &#123;go1.13&#125;</span><br><span class="line">â”œâ”€â”€ 1</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ 66551 (gocode) &#123;go1.11.2&#125;</span><br><span class="line">â”‚Â Â  â””â”€â”€ 137 (com.docker.vmnetd) &#123;go1.12.7&#125;</span><br><span class="line">â”œâ”€â”€ 65931</span><br><span class="line">â”‚Â Â  â””â”€â”€ 67476 (gops) &#123;go1.13&#125;</span><br><span class="line">â””â”€â”€ 746</span><br><span class="line">    â””â”€â”€ 807 (com.docker.supervisor) &#123;go1.12.13&#125;</span><br><span class="line">        â”œâ”€â”€ 811 (com.docker.backend) &#123;go1.12.13&#125;</span><br><span class="line">        â””â”€â”€ 810 (com.docker.driver.amd64-linux) &#123;go1.12.13&#125;</span><br></pre></td></tr></table></figure>

<h3 id="pidï¼šè¿›ç¨‹æ¦‚è¦ä¿¡æ¯"><a href="#pidï¼šè¿›ç¨‹æ¦‚è¦ä¿¡æ¯" class="headerlink" title="pidï¼šè¿›ç¨‹æ¦‚è¦ä¿¡æ¯"></a>pidï¼šè¿›ç¨‹æ¦‚è¦ä¿¡æ¯</h3><p>æŸ¥çœ‹è¿›ç¨‹çš„æ¦‚è¦ä¿¡æ¯ï¼Œégopsè¿›ç¨‹ä¹Ÿå¯ä»¥ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ gops 67292</span><br><span class="line">parent PID:	66333</span><br><span class="line">threads:	7</span><br><span class="line">memory usage:	0.018%</span><br><span class="line">cpu usage:	0.000%</span><br><span class="line">username:	shitaibin</span><br><span class="line">cmd+args:	.&#x2F;gops</span><br><span class="line">elapsed time:	11:28</span><br><span class="line">local&#x2F;remote:	127.0.0.1:54753 &lt;-&gt; :0 (LISTEN)</span><br><span class="line">âœ  ~</span><br><span class="line">âœ  ~ gops 807</span><br><span class="line">parent PID:	746</span><br><span class="line">threads:	28</span><br><span class="line">memory usage:	0.057%</span><br><span class="line">cpu usage:	0.003%</span><br><span class="line">username:	shitaibin</span><br><span class="line">cmd+args:	&#x2F;Applications&#x2F;Docker.app&#x2F;Contents&#x2F;MacOS&#x2F;com.docker.supervisor -watchdog fd:0</span><br><span class="line">elapsed time:	27-23:36:35</span><br><span class="line">local&#x2F;remote:	127.0.0.1:54832 &lt;-&gt; :0 ()</span><br><span class="line">local&#x2F;remote:	*:53849 &lt;-&gt; :0 ()</span><br><span class="line">local&#x2F;remote:	127.0.0.1:49473 &lt;-&gt; :0 (LISTEN)</span><br></pre></td></tr></table></figure>

<h3 id="stackï¼šå½“å‰è°ƒç”¨æ ˆ"><a href="#stackï¼šå½“å‰è°ƒç”¨æ ˆ" class="headerlink" title="stackï¼šå½“å‰è°ƒç”¨æ ˆ"></a>stackï¼šå½“å‰è°ƒç”¨æ ˆ</h3><p>æŸ¥çœ‹ä½¿ç”¨gopsçš„è¿›ç¨‹çš„è°ƒç”¨æ ˆï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ gops stack 67292</span><br><span class="line">goroutine 19 [running]:</span><br><span class="line">runtime&#x2F;pprof.writeGoroutineStacks(0x1197160, 0xc00009c028, 0x0, 0x0)</span><br><span class="line">	&#x2F;Users&#x2F;shitaibin&#x2F;goroot&#x2F;src&#x2F;runtime&#x2F;pprof&#x2F;pprof.go:679 +0x9d</span><br><span class="line">runtime&#x2F;pprof.writeGoroutine(0x1197160, 0xc00009c028, 0x2, 0x0, 0x0)</span><br><span class="line">	&#x2F;Users&#x2F;shitaibin&#x2F;goroot&#x2F;src&#x2F;runtime&#x2F;pprof&#x2F;pprof.go:668 +0x44</span><br><span class="line">runtime&#x2F;pprof.(*Profile).WriteTo(0x1275c60, 0x1197160, 0xc00009c028, 0x2, 0xc00009c028, 0x0)</span><br><span class="line">	&#x2F;Users&#x2F;shitaibin&#x2F;goroot&#x2F;src&#x2F;runtime&#x2F;pprof&#x2F;pprof.go:329 +0x3da</span><br><span class="line">github.com&#x2F;google&#x2F;gops&#x2F;agent.handle(0x1665008, 0xc00009c028, 0xc000014068, 0x1, 0x1, 0x0, 0x0)</span><br><span class="line">	&#x2F;Users&#x2F;shitaibin&#x2F;go&#x2F;src&#x2F;github.com&#x2F;google&#x2F;gops&#x2F;agent&#x2F;agent.go:185 +0x1ab</span><br><span class="line">github.com&#x2F;google&#x2F;gops&#x2F;agent.listen()</span><br><span class="line">	&#x2F;Users&#x2F;shitaibin&#x2F;go&#x2F;src&#x2F;github.com&#x2F;google&#x2F;gops&#x2F;agent&#x2F;agent.go:133 +0x2bf</span><br><span class="line">created by github.com&#x2F;google&#x2F;gops&#x2F;agent.Listen</span><br><span class="line">	&#x2F;Users&#x2F;shitaibin&#x2F;go&#x2F;src&#x2F;github.com&#x2F;google&#x2F;gops&#x2F;agent&#x2F;agent.go:111 +0x364</span><br><span class="line"></span><br><span class="line">goroutine 1 [sleep]:</span><br><span class="line">runtime.goparkunlock(...)</span><br><span class="line">	&#x2F;Users&#x2F;shitaibin&#x2F;goroot&#x2F;src&#x2F;runtime&#x2F;proc.go:310</span><br><span class="line">time.Sleep(0x34630b8a000)</span><br><span class="line">	&#x2F;Users&#x2F;shitaibin&#x2F;goroot&#x2F;src&#x2F;runtime&#x2F;time.go:105 +0x157</span><br><span class="line">main.main()</span><br><span class="line">	&#x2F;Users&#x2F;shitaibin&#x2F;Workspace&#x2F;golang_step_by_step&#x2F;gops&#x2F;example.go:15 +0xa3</span><br><span class="line"></span><br><span class="line">goroutine 18 [syscall]:</span><br><span class="line">os&#x2F;signal.signal_recv(0x0)</span><br><span class="line">	&#x2F;Users&#x2F;shitaibin&#x2F;goroot&#x2F;src&#x2F;runtime&#x2F;sigqueue.go:144 +0x96</span><br><span class="line">os&#x2F;signal.loop()</span><br><span class="line">	&#x2F;Users&#x2F;shitaibin&#x2F;goroot&#x2F;src&#x2F;os&#x2F;signal&#x2F;signal_unix.go:23 +0x22</span><br><span class="line">created by os&#x2F;signal.init.0</span><br><span class="line">	&#x2F;Users&#x2F;shitaibin&#x2F;goroot&#x2F;src&#x2F;os&#x2F;signal&#x2F;signal_unix.go:29 +0x41</span><br></pre></td></tr></table></figure>

<h3 id="memstats-å†…å­˜ä½¿ç”¨æƒ…å†µ"><a href="#memstats-å†…å­˜ä½¿ç”¨æƒ…å†µ" class="headerlink" title="memstats: å†…å­˜ä½¿ç”¨æƒ…å†µ"></a>memstats: å†…å­˜ä½¿ç”¨æƒ…å†µ</h3><p>æŸ¥çœ‹gopsè¿›ç¨‹å†…å­˜ä½¿ç”¨æƒ…å†µï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ gops memstats 67944</span><br><span class="line">alloc: 136.80KB (140088 bytes) &#x2F;&#x2F; å½“å‰åˆ†é…å‡ºå»æœªæ”¶å›çš„å†…å­˜æ€»é‡</span><br><span class="line">total-alloc: 152.08KB (155728 bytes) &#x2F;&#x2F; å·²åˆ†é…å‡ºå»çš„å†…å­˜æ€»é‡</span><br><span class="line">sys: 67.25MB (70518784 bytes) &#x2F;&#x2F; å½“å‰è¿›ç¨‹ä»OSè·å–çš„å†…å­˜æ€»é‡</span><br><span class="line">lookups: 0</span><br><span class="line">mallocs: 418 &#x2F;&#x2F; åˆ†é…çš„å¯¹è±¡æ•°é‡</span><br><span class="line">frees: 82 &#x2F;&#x2F; é‡Šæ”¾çš„å¯¹è±¡æ•°é‡</span><br><span class="line">heap-alloc: 136.80KB (140088 bytes) &#x2F;&#x2F; å½“å‰åˆ†é…å‡ºå»æœªæ”¶å›çš„å †å†…å­˜æ€»é‡</span><br><span class="line">heap-sys: 63.56MB (66650112 bytes) &#x2F;&#x2F; å½“å‰å †ä»OSè·å–çš„å†…å­˜</span><br><span class="line">heap-idle: 62.98MB (66035712 bytes) &#x2F;&#x2F; å½“å‰å †ä¸­ç©ºé—²çš„å†…å­˜é‡</span><br><span class="line">heap-in-use: 600.00KB (614400 bytes) &#x2F;&#x2F; å½“å‰å †ä½¿ç”¨ä¸­çš„å†…å­˜é‡</span><br><span class="line">heap-released: 62.89MB (65945600 bytes)</span><br><span class="line">heap-objects: 336 &#x2F;&#x2F; å †ä¸­å¯¹è±¡æ•°é‡</span><br><span class="line">stack-in-use: 448.00KB (458752 bytes) &#x2F;&#x2F; æ ˆä½¿ç”¨ä¸­çš„å†…å­˜é‡ </span><br><span class="line">stack-sys: 448.00KB (458752 bytes) &#x2F;&#x2F; æ ˆä»OSè·å–çš„å†…å­˜æ€»é‡ </span><br><span class="line">stack-mspan-inuse: 10.89KB (11152 bytes)</span><br><span class="line">stack-mspan-sys: 16.00KB (16384 bytes)</span><br><span class="line">stack-mcache-inuse: 13.56KB (13888 bytes)</span><br><span class="line">stack-mcache-sys: 16.00KB (16384 bytes)</span><br><span class="line">other-sys: 1.01MB (1062682 bytes)</span><br><span class="line">gc-sys: 2.21MB (2312192 bytes)</span><br><span class="line">next-gc: when heap-alloc &gt;&#x3D; 4.00MB (4194304 bytes) &#x2F;&#x2F; ä¸‹æ¬¡GCçš„æ¡ä»¶</span><br><span class="line">last-gc: 2020-03-16 10:06:26.743193 +0800 CST &#x2F;&#x2F; ä¸Šæ¬¡GCçš„ä¸–ç•Œ</span><br><span class="line">gc-pause-total: 83.84Âµs &#x2F;&#x2F; GCæ€»æš‚åœæ—¶é—´</span><br><span class="line">gc-pause: 44891 &#x2F;&#x2F; ä¸Šæ¬¡GCæš‚åœæ—¶é—´ï¼Œå•ä½çº³ç§’</span><br><span class="line">num-gc: 2 &#x2F;&#x2F; å·²è¿›è¡Œçš„GCæ¬¡æ•°</span><br><span class="line">enable-gc: true &#x2F;&#x2F; æ˜¯å¦å¼€å§‹GC</span><br><span class="line">debug-gc: false</span><br></pre></td></tr></table></figure>

<h3 id="stats-è¿è¡Œæ—¶ä¿¡æ¯"><a href="#stats-è¿è¡Œæ—¶ä¿¡æ¯" class="headerlink" title="stats: è¿è¡Œæ—¶ä¿¡æ¯"></a>stats: è¿è¡Œæ—¶ä¿¡æ¯</h3><p>æŸ¥çœ‹è¿è¡Œæ—¶ç»Ÿè®¡ä¿¡æ¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ gops stats 68125</span><br><span class="line">goroutines: 3</span><br><span class="line">OS threads: 12</span><br><span class="line">GOMAXPROCS: 8</span><br><span class="line">num CPU: 8</span><br></pre></td></tr></table></figure>

<h3 id="trace"><a href="#trace" class="headerlink" title="trace"></a>trace</h3><p>è·å–å½“å‰è¿è¡Œ5sçš„traceä¿¡æ¯ï¼Œä¼šæ‰“å¼€ç½‘é¡µï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ gops trace 68125</span><br><span class="line">Tracing now, will take 5 secs...</span><br><span class="line">Trace dump saved to: &#x2F;var&#x2F;folders&#x2F;5g&#x2F;rz16gqtx3nsdfs7k8sb80jth0000gn&#x2F;T&#x2F;trace116447431</span><br><span class="line">2020&#x2F;03&#x2F;16 10:23:37 Parsing trace...</span><br><span class="line">2020&#x2F;03&#x2F;16 10:23:37 Splitting trace...</span><br><span class="line">2020&#x2F;03&#x2F;16 10:23:37 Opening browser. Trace viewer is listening on http:&#x2F;&#x2F;127.0.0.1:55480</span><br></pre></td></tr></table></figure>

<h3 id="cpu-profile"><a href="#cpu-profile" class="headerlink" title="cpu profile"></a>cpu profile</h3><p>è·å–cpu profileï¼Œå¹¶è¿›å…¥äº¤äº’æ¨¡å¼ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ gops pprof-cpu 68125</span><br><span class="line">Profiling CPU now, will take 30 secs...</span><br><span class="line"></span><br><span class="line">Profile dump saved to: &#x2F;var&#x2F;folders&#x2F;5g&#x2F;rz16gqtx3nsdfs7k8sb80jth0000gn&#x2F;T&#x2F;profile431166544</span><br><span class="line">Binary file saved to: &#x2F;var&#x2F;folders&#x2F;5g&#x2F;rz16gqtx3nsdfs7k8sb80jth0000gn&#x2F;T&#x2F;binary765361519</span><br><span class="line">File: binary765361519</span><br><span class="line">Type: cpu</span><br><span class="line">Time: Mar 16, 2020 at 10:25am (CST)</span><br><span class="line">Duration: 30s, Total samples &#x3D; 0</span><br><span class="line">No samples were found with the default sample value type.</span><br><span class="line">Try &quot;sample_index&quot; command to analyze different sample values.</span><br><span class="line">Entering interactive mode (type &quot;help&quot; for commands, &quot;o&quot; for options)</span><br><span class="line">(pprof)</span><br><span class="line">(pprof) top</span><br><span class="line">Showing nodes accounting for 0, 0% of 0 total</span><br><span class="line">      flat  flat%   sum%        cum   cum%</span><br></pre></td></tr></table></figure>

<h3 id="memory-profile"><a href="#memory-profile" class="headerlink" title="memory profile"></a>memory profile</h3><p>è·å–memory profileï¼Œå¹¶è¿›å…¥äº¤äº’æ¨¡å¼ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ gops pprof-heap 68125</span><br><span class="line">Profile dump saved to: &#x2F;var&#x2F;folders&#x2F;5g&#x2F;rz16gqtx3nsdfs7k8sb80jth0000gn&#x2F;T&#x2F;profile292136242</span><br><span class="line">Binary file saved to: &#x2F;var&#x2F;folders&#x2F;5g&#x2F;rz16gqtx3nsdfs7k8sb80jth0000gn&#x2F;T&#x2F;binary693335273</span><br><span class="line">File: binary693335273</span><br><span class="line">Type: inuse_space</span><br><span class="line">Time: Mar 16, 2020 at 10:27am (CST)</span><br><span class="line">No samples were found with the default sample value type.</span><br><span class="line">Try &quot;sample_index&quot; command to analyze different sample values.</span><br><span class="line">Entering interactive mode (type &quot;help&quot; for commands, &quot;o&quot; for options)</span><br><span class="line">(pprof)</span><br><span class="line">(pprof) traces</span><br><span class="line">File: binary693335273</span><br><span class="line">Type: inuse_space</span><br><span class="line">Time: Mar 16, 2020 at 10:27am (CST)</span><br><span class="line">-----------+-------------------------------------------------------</span><br><span class="line">     bytes:  256kB</span><br><span class="line">         0   compress&#x2F;flate.(*compressor).init</span><br><span class="line">             compress&#x2F;flate.NewWriter</span><br><span class="line">             compress&#x2F;gzip.(*Writer).Write</span><br><span class="line">             runtime&#x2F;pprof.(*profileBuilder).build</span><br><span class="line">             runtime&#x2F;pprof.profileWriter</span><br><span class="line">-----------+-------------------------------------------------------</span><br><span class="line">     bytes:  64kB</span><br><span class="line">         0   compress&#x2F;flate.newDeflateFast</span><br><span class="line">             compress&#x2F;flate.(*compressor).init</span><br><span class="line">             compress&#x2F;flate.NewWriter</span><br><span class="line">             compress&#x2F;gzip.(*Writer).Write</span><br><span class="line">             runtime&#x2F;pprof.(*profileBuilder).build</span><br><span class="line">             runtime&#x2F;pprof.profileWriter</span><br><span class="line">-----------+-------------------------------------------------------</span><br></pre></td></tr></table></figure>

<h2 id="ä½¿ç”¨è¿œç¨‹è¿æ¥"><a href="#ä½¿ç”¨è¿œç¨‹è¿æ¥" class="headerlink" title="ä½¿ç”¨è¿œç¨‹è¿æ¥"></a>ä½¿ç”¨è¿œç¨‹è¿æ¥</h2><p>agentçš„é»˜è®¤é…ç½®<code>Option&#123;&#125;</code>ï¼Œç›‘å¬çš„æ˜¯ç¯å›åœ°å€ã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ sudo netstat -nap | grep 414</span><br><span class="line">âœ  ~ netstat -nap | grep `pgrep gopsexample`</span><br><span class="line">(Not all processes could be identified, non-owned process info</span><br><span class="line"> will not be shown, you would have to be root to see it all.)</span><br><span class="line">tcp        0      0 127.0.0.1:36812         0.0.0.0:*               LISTEN      414/./gopsexample</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹ç¨‹åºï¼Œåœ¨<code>Option</code>ä¸­è®¾ç½®ç›‘å¬çš„åœ°å€å’Œç«¯å£ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">agent.Listen(agent.Options&#123;Addr:<span class="string">&quot;0.0.0.0:8848&quot;</span>&#125;)</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿œç¨‹ä¸»æœºä¸Šé‡æ–°ç¼–è¯‘ã€é‡å¯è¿›ç¨‹ï¼Œç¡®è®¤è¿›ç¨‹ç›‘å¬çš„ç«¯å£ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ netstat -nap | grep `pgrep gopsexample`</span><br><span class="line">(Not all processes could be identified, non-owned process info</span><br><span class="line"> will not be shown, you would have to be root to see it all.)</span><br><span class="line">tcp6       0      0 :::8848                 :::*                    LISTEN      887/./gopsexample</span><br></pre></td></tr></table></figure>

<p>åœ¨æœ¬åœ°ä¸»æœºä¸Šä½¿ç”¨gopsè¿æ¥è¿œç«¯goè¿›ç¨‹ï¼Œå¹¶æŸ¥çœ‹æ•°æ®ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ gops stats 192.168.9.137:8848</span><br><span class="line">goroutines: 3</span><br><span class="line">OS threads: 9</span><br><span class="line">GOMAXPROCS: 4</span><br><span class="line">num CPU: 4</span><br></pre></td></tr></table></figure>

<p><code>gops</code>åé¢åªèƒ½è·ŸpidæŸ¥çœ‹è¿›ç¨‹ç®€è¦ä¿¡æ¯ï¼Œä¸èƒ½è·Ÿipå’ŒportæŸ¥çœ‹è¿œç«¯goè¿›ç¨‹ç®€è¦ä¿¡æ¯ï¼Œè¿™äº›ç®€è¦ä¿¡æ¯å¯ä»¥é€šè¿‡å­å‘½ä»¤æ±‡é›†èµ·æ¥ã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ gops 192.168.9.137:8848</span><br><span class="line">gops: unknown subcommand</span><br><span class="line">âœ  ~ </span><br><span class="line">âœ  ~ gops version 192.168.9.137:8848</span><br><span class="line">go1.13</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="ä¸Šä¸€é¡µ"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="ä¸‹ä¸€é¡µ"></i></a>
  </nav>


<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">æµ™ICP </a><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=18051706" rel="noopener" target="_blank">å¤‡18051706 </a>
  </div>

<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">å¤§å½¬</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> å¼ºåŠ›é©±åŠ¨
  </div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/next-boot.js"></script>

  

<script src="//cdn.jsdelivr.net/npm/algoliasearch@4.8.2/dist/algoliasearch-lite.umd.js"></script>
<script src="//cdn.jsdelivr.net/npm/instantsearch.js@4.8.7/dist/instantsearch.production.min.js"></script><script src="/js/algolia-search.js"></script>






  







</body>
</html>
